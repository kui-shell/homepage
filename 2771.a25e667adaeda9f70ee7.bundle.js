(self.webpackChunkkui_shell=self.webpackChunkkui_shell||[]).push([[2771],{22771:(e,t,n)=>{"use strict";n.r(t),n.d(t,{fetchMarkdownFile:()=>a,default:()=>c});var i=n(51173),o=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{c(i.next(e))}catch(e){r(e)}}function s(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};const r={command:"commentary",strict:"commentary",example:"commentary -f [<markdown file path>]",docs:"Commentary",optional:[{name:"--title",alias:"-t",docs:"Title for the commentary"},{name:"--base-url",alias:"-b",docs:"Base URL for images"},{name:"--file",alias:"-f",docs:"File that contains the texts"}]};function a(e,t){return o(this,void 0,void 0,(function*(){const n=(0,i.findFile)((0,i.expandHomeDir)(e));if("md"!==e.substring(e.lastIndexOf(".")+1))throw new Error("File extension not support");{const e=(yield t.tab.REPL.rexec(`vfs fstat ${t.tab.REPL.encodeComponent(n)} --with-data`)).content;if(e.isDirectory)throw new Error("Invalid filepath");return e.data}}))}function s(e){return o(this,void 0,void 0,(function*(){const{title:t}=e.parsedOptions,n=e.parsedOptions.file||e.parsedOptions.f,i=(n?yield a(n,e):e.command.trim().slice(e.command.indexOf(" ")+1).trim().replace(/\\n/g,"\n").replace(/\\t/g,"\t").replace(/(-t|--title)\s+\S+/,""))||"#";if(void 0!==i)return"#"===i||"commentary"===e.command?{apiVersion:"kui-shell/v1",kind:"CommentaryResponse",props:{title:t,children:"",baseUrl:e.parsedOptions["base-url"]}}:{apiVersion:"kui-shell/v1",kind:"CommentaryResponse",props:{title:t,children:i,baseUrl:e.parsedOptions["base-url"]}};throw new Error("Insufficient arguments: must specify either --file or -f, or provide a comment on the command line")}))}const c=e=>o(void 0,void 0,void 0,(function*(){e.listen("/commentary",s,{usage:r,outputOnly:!0}),e.listen("/#",s,{usage:r,outputOnly:!0})}))}}]);