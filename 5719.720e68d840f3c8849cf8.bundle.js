(self.webpackChunkkui_shell=self.webpackChunkkui_shell||[]).push([[5719],{85719:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>c});var r=o(67294),n=o(90112),s=o(51173),a=o(4766),i=o(94550);class c extends r.Component{constructor(e){super(e),this.state={cleaners:[],wrapper:r.createRef(),editor:void 0,catastrophicError:void 0}}static getDerivedStateFromError(e){return{catastrophicError:e}}componentDidCatch(e,t){console.error("catastrophic error in Editor",e,t)}shouldComponentUpdate(e,t){return!t.editor||!!t.catastrophicError}static getDerivedStateFromProps(e,t){return t.editor&&t.editor.getValue()!==e.content&&t.editor.setValue(e.content),t}componentWillUnmount(){this.destroyMonaco()}destroyMonaco(){this.state.cleaners.forEach((e=>e()))}static onChange(e,t){return()=>{e.onContentChange(t.getValue())}}registerKeyboardShortcuts(e){const{onSave:t,onCancel:o}=this.props;t&&(e.addCommand(n.KeyMod.CtrlCmd|n.KeyCode.KEY_S,(()=>{t(e.getValue())})),e.addCommand(n.KeyMod.Shift|n.KeyCode.Enter,(()=>{t(e.getValue())}))),o&&e.addCommand(n.KeyCode.Escape,(()=>{o(e.getValue())}))}initMonaco(e,t){const o=[];try{const r={value:e.content,readOnly:void 0===e.readonly||e.readonly,fontSize:e.fontSize||(0,a.Z)(),language:/^(ba)?sh$/.test(e.contentType)?"shell":e.contentType,simple:e.simple},l={theme:e.light?"vs":"vs-dark"},p=Object.assign((0,i.Z)(r),r,l),d=n.editor.create(t.wrapper.current,p);if(this.registerKeyboardShortcuts(d),p.readOnly&&e.simple){const e=void 0!==this.props.minHeight?this.props.minHeight:250;t.wrapper.current.style.height=Math.min(.3*window.innerHeight,Math.max(e,d.getContentHeight()))+"px"}t.wrapper.current.getValueForTests=()=>d.getValue(),d.onDidChangeModelContent(c.onChange(e,d)),p.readOnly||setTimeout((()=>d.focus()));const h=()=>{d.updateOptions({fontSize:(0,a.Z)()})};s.eventChannelUnsafe.on("/zoom",h),o.push((()=>s.eventChannelUnsafe.off("/zoom",h)));const u=()=>{d.layout()};s.eventBus.onTabLayoutChange(e.tabUUID,u),o.push((()=>s.eventBus.offTabLayoutChange(e.tabUUID,u))),o.push((()=>{d.dispose();const e=d.getModel();e&&e.dispose()})),this.setState({editor:d,cleaners:o})}catch(e){console.error("Error initing Monaco: ",e),this.setState({catastrophicError:e})}}componentDidMount(){!this.state.editor&&this.state.wrapper.current?this.initMonaco(this.props,this.state):this.props.scrollIntoView&&this.state.wrapper.current&&this.state.wrapper.current.scrollIntoView()}render(){if(this.state.catastrophicError)return r.createElement("div",{className:"oops"}," ",this.state.catastrophicError.toString());{const e="monaco-editor-wrapper"+(this.props.className?" "+this.props.className:"");return r.createElement("div",{className:e,ref:this.state.wrapper})}}}},94550:(e,t,o)=>{"use strict";o.d(t,{Z:()=>n});var r=o(4766);const n=e=>({automaticLayout:!0,minimap:{enabled:!1},codeLens:!1,quickSuggestions:!1,contextmenu:!1,scrollBeyondLastLine:!1,scrollBeyondLastColumn:2,scrollbar:{alwaysConsumeMouseWheel:!1},cursorStyle:"block",fontFamily:"var(--font-monospace)",fontSize:e.fontSize||(0,r.Z)(),glyphMargin:!e.readOnly&&!e.simple,links:!e.simple,folding:!e.simple||!/markdown|text|shell/i.test(e.language),lineNumbers:e.simple?"off":"on",wordWrap:e.simple?"on":void 0,renderFinalNewline:!e.simple,lineDecorationsWidth:e.simple?0:void 0})},4766:(e,t,o)=>{"use strict";function r(){return parseInt(getComputedStyle(document.querySelector("body")).getPropertyValue("font-size").replace(/px$/,""),10)}o.d(t,{Z:()=>r})}}]);