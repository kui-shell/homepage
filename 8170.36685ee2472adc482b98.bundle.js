(self.webpackChunkkui_shell=self.webpackChunkkui_shell||[]).push([[8170,2383,7208],{31563:(e,n,t)=>{"use strict";t.d(n,{E6:()=>i.getSessionForTab,fF:()=>o.XN,Io:()=>o.Io});t(82208),t(53462);var i=t(36065),o=t(68993)},68993:(e,n,t)=>{"use strict";t.d(n,{XN:()=>a,Io:()=>l,MA:()=>u});var i=t(11227),o=t.n(i),s=t(51173),r=function(e,n,t,i){return new(t||(t=Promise))((function(o,s){function r(e){try{a(i.next(e))}catch(e){s(e)}}function c(e){try{a(i.throw(e))}catch(e){s(e)}}function a(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(r,c)}a((i=i.apply(e,n||[])).next())}))};const c=o()("plugins/bash-like/cmds/catchall"),a=({tab:e,command:n,argvNoOptions:i,execOptions:o,parsedOptions:c,createOutputStream:a})=>r(void 0,void 0,void 0,(function*(){const r=e=>{throw e.message&&"string"==typeof e.message?new Error(e.message.replace(/[a-zA-Z0-9/]+:\s*/,"").trim()):e},l=(o.raw||o.type===s.ExecType.Nested)&&void 0===o.quiet&&void 0===o.echo&&void 0===o.replSilence,u=l||o.isProxied?o:Object.assign({},{stdout:yield a()},o),d=n.replace(/^(!|sendtopty)\s+/,"");if((0,s.isHeadless)()||!(0,s.inBrowser)()&&l){const{doExec:e}=yield t.e(5438).then(t.bind(t,5438)),n=yield e(d,u).catch(r);if(l&&("number"==typeof n||"boolean"==typeof n))return n;if(l&&"string"==typeof n)try{return isNaN(parseInt(n))?JSON.parse(n):n}catch(e){}return n}{const{doExec:n}=yield Promise.all([t.e(8575),t.e(9267),t.e(2320),t.e(5301),t.e(1051)]).then(t.bind(t,51153)),o=()=>n(e,d,i,c,u);if(l){u.quiet=!0,u.echo=!1,u.replSilence=!0;let e="";return u.onInit=()=>n=>{"string"==typeof n&&(e+=n)},o().then((()=>e)).catch(r)}return o().catch(r)}}));function l(e){return r(this,void 0,void 0,(function*(){return new Promise(((n,t)=>r(this,void 0,void 0,(function*(){let i="";const o=Object.assign({},e.execOptions,{rethrowErrors:!0,quiet:!0,replSilence:!0,echo:!1,onInit:()=>e=>{"string"==typeof e&&(i+=e)}}),s=Object.assign({},e,{execOptions:o});yield a(s).catch((e=>{console.error(e),e.message=i||e.message,t(e)})),n(i)}))))}))}const u=e=>{if(!(0,s.inBrowser)()||(0,s.hasProxy)())return e.catchall((()=>!0),a,0);c("skipping catchall registration: in browser and no remote proxy to support it")}},36065:(e,n,t)=>{"use strict";t.r(n),t.d(n,{getChannelForTab:()=>d,getSessionForTab:()=>f,init:()=>g,invalidateSession:()=>m,pollUntilOnline:()=>h});var i=t(11227),o=t.n(i),s=t(51173),r=t(95233);const c=o()("plugins/bash-like/pty/ui");var a=function(e,n,t,i){return new(t||(t=Promise))((function(o,s){function r(e){try{a(i.next(e))}catch(e){s(e)}}function c(e){try{a(i.throw(e))}catch(e){s(e)}}function a(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(r,c)}a((i=i.apply(e,n||[])).next())}))};const l=(0,s.i18n)("plugin-bash-like"),u=o()("plugins/bash-like/pty/session");function d(e){return e.ws}function f(e){return a(this,void 0,void 0,(function*(){if(void 0===e._kui_session&&(0,s.inElectron)()){const n=new r.IJ;return yield n.init(),e._kui_session=Promise.resolve(n),e._kui_session}return e._kui_session}))}function h(e){return new Promise((n=>{let t=!1;const i=setTimeout((()=>{t||(c("setOffline"),s.eventChannelUnsafe.emit("/proxy/offline"))}),5e3),o=(r=0)=>(u("trying to establish session",e),e.REPL.qexec("echo initializing session",void 0,void 0,{tab:e}).then((()=>{t=!0,clearTimeout(i),c("setOnline"),s.eventChannelUnsafe.emit("/proxy/online"),n()})).catch((e=>{const n=e;return 503!==n.code&&console.error("error establishing session",n.code,n.statusCode,n),setTimeout((()=>o(r+1)),r<10?2e3:r<100?4e3:1e4),l("Could not establish a new session")})));o()}))}let p;function v(e){return a(this,void 0,void 0,(function*(){const n=p||new Promise(((n,t)=>a(this,void 0,void 0,(function*(){try{yield h(e),e.classList.add("kui--session-init-done"),n(d(e))}catch(e){t(e)}}))));p||(p=n),e._kui_session=n,yield n,e.classList.add("kui--session-init-done")}))}function m(e){p=void 0,s.eventBus.emit("/tab/offline",e),s.eventBus.emitWithTabId("/tab/offline",e.state.uuid)}function g(e){return a(this,void 0,void 0,(function*(){const{proxyServer:n}=yield t.e(9599).then(t.t.bind(t,69599,19)).catch((()=>(console.log("using default proxy configuration"),{proxyServer:{enabled:!1}})));if((0,s.inBrowser)()&&!1!==n.enabled){u("initializing pty sessions");const{eventBus:n}=yield Promise.resolve().then(t.bind(t,51173));e.registerSessionInitializer(v),n.on("/tab/close",(e=>a(this,void 0,void 0,(function*(){try{u("closing session for tab");const n=d(e);n&&n.close()}catch(e){console.error("error terminating session for closed tab",e)}}))))}}))}},14291:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>h});var i=t(31563),o=function(e,n,t,i){return new(t||(t=Promise))((function(o,s){function r(e){try{a(i.next(e))}catch(e){s(e)}}function c(e){try{a(i.throw(e))}catch(e){s(e)}}function a(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(r,c)}a((i=i.apply(e,n||[])).next())}))};const s=t(77428);function r({argvNoOptions:e,parsedOptions:n}){return 2===e.length&&!!(n.a||n.all||n.l||n.list||function(e){return 1===Object.keys(e).length}(n))}function c(e){return r(e)?function(e){return o(this,void 0,void 0,(function*(){e.argvNoOptions.push("--no-pager"),e.argvNoOptions.push("--color=never"),e.command=e.command.replace("git","git --no-pager"),e.command=`${e.command} --color=never`;const n=s(yield(0,i.Io)(e));let t=0;const o=n.trim().split(/\n/).map(((e,n)=>{const i="*"===e.charAt(0),o=e.replace(/^\*?\s*/,"").trim();return i&&(t=n),{nameIdx:0,cells:[o],onSelect:`git checkout ${o}`}}));return{apiVersion:"kui-shell/v1",kind:"RadioTable",title:"Git Branches",defaultSelectedIdx:t,header:{cells:["Branch"]},body:o}}))}(e):(0,i.fF)(e)}var a=t(51173),l=t(26470),u=function(e,n,t,i){return new(t||(t=Promise))((function(o,s){function r(e){try{a(i.next(e))}catch(e){s(e)}}function c(e){try{a(i.throw(e))}catch(e){s(e)}}function a(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(r,c)}a((i=i.apply(e,n||[])).next())}))};const d=(0,a.i18n)("plugin-git");function f(e){return u(this,void 0,void 0,(function*(){try{const{argvNoOptions:n,REPL:t}=e,i=n[n.indexOf("diff")+1],o=(0,a.findFile)((0,a.expandHomeDir)(i)),s=(0,l.basename)(i),r=i.substring(i.lastIndexOf(".")+1),c=(0,l.dirname)(i),u="."===c?void 0:c,f=function(e){switch(e){case"sh":return"shell";case"md":return"text/markdown";case"html":return"text/html";case"yaml":case"json":return e;default:return"text/plain"}}(r),[h,p]=yield Promise.all([t.qexec(`git show HEAD:${i}`),t.rexec(`vfs fstat ${t.encodeComponent(i)} --with-data`)]),v={mode:"git diff",label:d("Git Diff"),content:{a:h,b:p.content.data},contentType:f};return{apiVersion:"kui-shell/v1",kind:"File",metadata:{name:s,namespace:u},toolbarText:{type:"info",text:d("Showing changes between the working tree and previous commit.")},modes:[v],spec:{filepath:i,fullpath:o}}}catch(n){return console.error("failed at git diff",n),(0,i.fF)(e)}}))}function h(e){!function(e){e.listen("/git/branch",c,{flags:{boolean:["a","all","f","force","i","ignore-case","d","delete","D","m","move","c","copy","C","l","list","create-reflog","edit-description","v","verbose","q","quiet","t","track","u","set-upstream-to","unset-upstream","r","remotes"]}})}(e),function(e){e.listen("/git/diff",f)}(e)}},32974:e=>{"use strict";e.exports=({onlyFirst:e=!1}={})=>{const n=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:[a-zA-Z\\d]*(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(n,e?void 0:"g")}},77428:(e,n,t)=>{"use strict";const i=t(32974);e.exports=e=>"string"==typeof e?e.replace(i(),""):e},32383:()=>{}}]);