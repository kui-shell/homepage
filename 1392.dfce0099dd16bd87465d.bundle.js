(self.webpackChunkkui_shell=self.webpackChunkkui_shell||[]).push([[1392],{63124:(e,t,i)=>{"use strict";i.d(t,{Y:()=>a});var r=i(70655),n=i(67294);const a=e=>{var{children:t,className:i}=e,a=(0,r.__rest)(e,["children","className"]);return n.createElement("caption",Object.assign({className:i},a),t)};a.displayName="Caption"},48657:(e,t,i)=>{"use strict";i.d(t,{Fq:()=>n,Nq:()=>s,Do:()=>c,hp:()=>l});var r=function(e,t,i,r){return new(i||(i=Promise))((function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};function n(e,t){return r(this,void 0,void 0,(function*(){delete e.originatingCommand,delete e.kuiRawData,delete e.isKubeResource;const{safeDump:r}=yield i.e(3320).then(i.t.bind(i,93320,23)),n=r(e);return yield t.REPL.qexec(`cat <<"EOF" | kubectl apply -f -\n${n}\nEOF`)}))}function a(e,t){return r(this,void 0,void 0,(function*(){return(yield t.REPL.qexec(`kubectl get deployments -n ${e.destination_workload_namespace} ${e.destination_workload} -o json`)).spec.template.metadata.labels}))}function o(e,t,i){return r(this,void 0,void 0,(function*(){return(yield i.REPL.qexec(`kubectl get svc -n ${t} ${e} -o json`)).spec.ports[0].port}))}function s(e,t){var i={};i={apiVersion:"networking.istio.io/v1alpha3",kind:"DestinationRule",metadata:{name:e.service_name+"."+e.service_namespace+".iter8-experiment",namespace:e.service_namespace,labels:{"iter8-tools/host":e.service_name,"iter8-tools/role":"stable"}},spec:{host:e.service_name,subsets:[]}},setTimeout((()=>r(this,void 0,void 0,(function*(){for(const[r,n]of Object.entries(e)){if("service_name"===r)continue;if("service_namespace"===r)continue;if("edgeService"===r)continue;if("hostGateways"===r)continue;let[e]=yield Promise.all([a(n.version_labels,t)]);i.spec.subsets.push({labels:e,name:r})}console.log("Applying Destination Rule"),n(i,t),function(e,t,i){var a={};if(a={apiVersion:"networking.istio.io/v1alpha3",kind:"VirtualService",metadata:{name:t.service_name+"."+t.service_namespace+".iter8-experiment",namespace:t.service_namespace,labels:{"iter8-tools/host":t.service_name,"iter8-tools/role":"stable"}},spec:{hosts:[t.service_name],gateways:["mesh"],http:[{route:[]}]}},!0===t.edgeService)for(var s=0;s<t.hostGateways.length;s++)a.spec.hosts.push(t.hostGateways[s].name),a.spec.gateways.push(t.hostGateways[s].gateway);setTimeout((()=>r(this,void 0,void 0,(function*(){const[r]=yield Promise.all([o(t.service_name,t.service_namespace,i)]),s=e.spec.subsets;a.spec.http[0].route=[];for(let i=0;i<s.length;i++)a.spec.http[0].route.push({destination:{host:e.spec.host,subset:s[i].name,port:{number:r}},weight:t[s[i].name].traffic_percentage});console.log("Applying Virtual Service"),n(a,i)}))))}(i,e,t)}))))}function c(e){let t=[];for(let i=0;i<e.length;i++)t.push(e[i].split);return 100===t.reduce(((e,t)=>e+t),0)}function l(e,t,i){let r={service_name:t,service_namespace:e};for(let t=0;t<i.length;t++)r[`${i[t].version}`]={version_labels:{destination_workload_namespace:e,destination_workload:i[t].version},traffic_percentage:i[t].split};return r}},71392:(e,t,i)=>{"use strict";i.r(t),i.d(t,{FormTypes:()=>w,MetricTypes:()=>b,default:()=>x});var r=i(67294),n=i(93320),a=i(24107),o=i(73827),s=i(3134),c=i(86151),l=i(54976),d=i(63124),m=i(62308);class u extends r.Component{render(){const{errorString:e}=this.props;return r.createElement("div",{className:"infotext"},r.createElement("p",null,"Error Message:"),r.createElement("div",{className:"box"},r.createElement("kbd",null,r.createElement("pre",null,JSON.stringify(e,null,2)))))}}var p=i(48657),h=i(88157);function f(e,t,i,r){try{const a=(0,n.safeLoad)(e.data["counter_metrics.yaml"]),o=(0,n.safeLoad)(e.data["ratio_metrics.yaml"]),s=(0,h.EP)(e);return console.log(`Deleting metric: ${t} Type: ${i}`),s.data["counter_metrics.yaml"]=(0,n.safeDump)(a.filter((e=>e.name!==t))),s.data["ratio_metrics.yaml"]=(0,n.safeDump)(o.filter((e=>e.name!==t))),(0,p.Fq)(s,r),!0}catch(e){return!1}}function M(e,t,i,r){try{const a=(0,n.safeLoad)(e.data["counter_metrics.yaml"]),o=(0,n.safeLoad)(e.data["ratio_metrics.yaml"]),s=(0,h.EP)(e);return i===b.counter?a.push(t):o.push(t),s.data["counter_metrics.yaml"]=(0,n.safeDump)(a),s.data["ratio_metrics.yaml"]=(0,n.safeDump)(o),(0,p.Fq)(s,r),!0}catch(e){return!1}}var v=function(e,t,i,r){return new(i||(i=Promise))((function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};let g,y;var w,b,S;!function(e){e.add="add",e.edit="edit"}(w||(w={})),function(e){e.counter="counter",e.ratio="ratio"}(b||(b={})),function(e){e[e.input=0]="input",e[e.dropdown=1]="dropdown"}(S||(S={}));const E="Please select a counter metric",k="Counter metric ID used to calculate ratio metric",O=[{name:"name",printableName:"Name",description:"Unique identifier for counter metric",type:S.input,required:!0,invalidChecks:{add:{invalidText:"Another counter metric already has this name",check:(e,t)=>t.counterMetricNames.includes(e)}}},{name:"query_template",printableName:"Query template",description:"Prometheus query used to populate counter metric",type:S.input,required:!0},{name:"preferred_direction",printableName:"Preferred direction",description:"Whether a higher or lower counter metric is preferred. Default: lower",type:S.dropdown,required:!0,dropdownOptions:[{printableOption:"Lower",value:"lower"},{printableOption:"Higher",value:"higher"}]},{name:"units",printableName:"Units",description:"Optional: units of the counter metric",type:S.input,required:!1}],N=[{name:"name",printableName:"Name",description:"Unique identifier for ratio metric",type:S.input,required:!0,invalidChecks:{add:{invalidText:"Another ratio metric already has this name",check:(e,t)=>t.ratioMetricNames.includes(e)}}},{name:"numerator",printableName:"Numerator",description:k,type:S.dropdown,required:!0,dropdownOptions:[],noDefaultDropdownOptionPlaceholder:E},{name:"denominator",printableName:"Denominator",description:k,type:S.dropdown,required:!0,dropdownOptions:[],noDefaultDropdownOptionPlaceholder:E},{name:"preferred_direction",printableName:"Preferred direction",description:"Whether a higher or lower ratio metric is preferred. Default: lower",type:S.dropdown,required:!0,dropdownOptions:[{printableOption:"Lower",value:"lower"},{printableOption:"Higher",value:"higher"}]},{name:"zero_to_one",printableName:"Zero to one",description:"Optional: whether the ratio metric is between 0 and 1, inclusive",type:S.dropdown,required:!1,dropdownOptions:[{printableOption:"True",value:!0},{printableOption:"False",value:!1}],noDefaultDropdownOptionPlaceholder:"None selected"}];function D(e){const t={};return Object.values(e).forEach((e=>{if(e.type===S.input)t[e.name]="";else if(!e.noDefaultDropdownOptionPlaceholder){if(!(e.dropdownOptions.length>0))throw new Error(`No known dropdown options for attribute '${e.name}'`);t[e.name]=e.dropdownOptions[0].value}})),t}const C=D(O),_=D(N);var T;function q(e){const t=[];return e.forEach((e=>{t.push({printableOption:e,value:e})})),t}!function(e){e[e.getMetrics=0]="getMetrics",e[e.addMetric=1]="addMetric",e[e.editMetric=2]="editMetric",e[e.error=3]="error"}(T||(T={}));class x extends r.Component{constructor(e){super(e),this.constructorHelper=()=>{try{const e=(0,n.safeLoad)(this.state.rawConfigMap.data["counter_metrics.yaml"]),t=(0,n.safeLoad)(this.state.rawConfigMap.data["ratio_metrics.yaml"]),i=(0,h.EP)(this.state.rawConfigMap),r=e.map((e=>e.name)),a=t.map((e=>e.name)),o=q(r),s=N.find((e=>"numerator"===e.name)),c=N.find((e=>"denominator"===e.name));s.dropdownOptions=o,c.dropdownOptions=o,g=O.filter((e=>e.required)).map((e=>e.name)),y=N.filter((e=>e.required)).map((e=>e.name));const{counterMetricsState:l,ratioMetricsState:d}=this.generateMetricsStates(e,t);this.setState({configMap:i,counterMetrics:e,ratioMetrics:t,counterMetricNames:r,ratioMetricNames:a,ratioMetricsState:d,counterMetricsState:l})}catch(e){throw console.log(e),new Error("Could not obtain metric config")}},this.refreshState=()=>{console.log("Refreshed state");try{this.setState({configMap:null,rawConfigMap:{},counterMetrics:[],ratioMetrics:[],counterMetricNames:[],ratioMetricNames:[],counterMetricsState:{},ratioMetricsState:{},display:T.getMetrics,formSubmitted:!1,errorString:"None"}),this.getConfigMap()}catch(e){this.setState({configMap:void 0,counterMetrics:void 0,ratioMetrics:void 0,counterMetricNames:void 0,ratioMetricNames:void 0,counterMetricsState:void 0,ratioMetricsState:void 0,formSubmitted:void 0,display:T.getMetrics,errorString:e})}},this.generateMetricsStates=(e,t)=>{const i={},r={};return e.forEach((e=>{i[e.name]={name:e.name,isDeleted:!1,alsoDelete:[],alsoRestore:[],details:e,custom:!h.zL.counter.includes(e.name)}})),t.forEach((e=>{r[e.name]={name:e.name,isDeleted:!1,alsoDelete:[],alsoRestore:[e.numerator,e.denominator],details:e,custom:!h.zL.ratio.includes(e.name)};try{i[e.numerator].alsoDelete.push(e.name)}catch(t){throw new Error(`Ratio metric '${e.name}' has numerator metric\n          '${e.numerator}' which is not defined.`)}try{i[e.denominator].alsoDelete.push(e.name)}catch(t){throw new Error(`Ratio metric '${e.name}' has denominator metric\n          '${e.denominator}' which is not defined.`)}})),{counterMetricsState:i,ratioMetricsState:r}},this.getInitialRowsFromObjectKeys=e=>Object.keys(e).map((e=>({id:e,isExpanded:!1}))),this.renderIter8ImmutableMetricWarning=e=>r.createElement("div",{className:"warningtext"},"Warning: Cannot ",e," iter8 metrics"),this.renderDeleteWarning=(e,t)=>r.createElement("div",null,r.createElement("div",{className:"deletedtext"},"Deleted"),r.createElement("div",{className:"clickableicon",onClick:()=>this.restoreMetricHandler(e,t)},r.createElement(a.PJ,{icon:"Retry"}),t===b.ratio&&this.state.ratioMetricsState[e].custom&&this.state.ratioMetricsState[e].alsoRestore.length?r.createElement("div",{className:"warningtext"},"Warning: Will also restore ",this.state.ratioMetricsState[e].alsoRestore.join(", ")):null)),this.displayGetMetrics=()=>{this.setState({display:T.getMetrics,selectedMetricName:void 0,selectedType:void 0,newMetric:void 0,formSubmitted:void 0})},this.displayAddMetric=e=>{const t=e===b.counter?C:_;this.setState({display:T.addMetric,selectedType:e,newMetric:t,formSubmitted:!1})},this.displayEditMetric=(e,t)=>{const{counterMetrics:i,ratioMetrics:r}=this.state,n=t===b.counter?i.find((t=>t.name===e)):r.find((t=>t.name===e)),a=JSON.parse(JSON.stringify(n)),o=t===b.counter?C:_,s=Object.assign(Object.assign({},o),a);this.setState({display:T.editMetric,selectedMetricName:e,selectedType:t,newMetric:s,formSubmitted:!1})},this.addMetricHandler=e=>{console.log("click submitted"),this.setState({formSubmitted:!0});const{configMap:t,counterMetrics:i,ratioMetrics:r,selectedType:a,newMetric:o}=this.state;if(a===b.counter){console.log("new counter metric config:",o);const e=!i.some((e=>e.name===o.name)),a=g.every((e=>o[e]));if(a&&e){const e={};Object.entries(o).forEach((([t,i])=>{O.find((e=>e.name===t)).type===S.input?i.length>0&&(e[t]=i):e[t]=i})),i.push(e);const a=(0,n.safeDump)(i);t.data["counter_metrics.yaml"]=a,(0,p.Fq)(t,this.args);const s=q(i.map((e=>e.name))),c=N.find((e=>"numerator"===e.name)),l=N.find((e=>"denominator"===e.name));c.dropdownOptions=s,l.dropdownOptions=s;const{counterMetricsState:d}=this.generateMetricsStates(i,r);this.setState({configMap:t,counterMetrics:i,display:T.getMetrics,counterMetricsState:d,selectedType:void 0,newMetric:void 0,formSubmitted:void 0})}else console.log("uniqueName:",e),console.log("allRequiredFieldsPresent:",a)}else{console.log("new ratio metric config:",o);const e=!r.some((e=>e.name===o.name)),a=y.every((e=>o[e]));if(a&&e){const e={};Object.entries(o).forEach((([t,i])=>{N.find((e=>e.name===t)).type===S.input?i.length>0&&(e[t]=i):e[t]=i})),r.push(e);const a=(0,n.safeDump)(r);t.data["ratio_metrics.yaml"]=a,(0,p.Fq)(t,this.args);const s=q(i.map((e=>e.name))),c=N.find((e=>"numerator"===e.name)),l=N.find((e=>"denominator"===e.name));c.dropdownOptions=s,l.dropdownOptions=s;const{ratioMetricsState:d}=this.generateMetricsStates(i,r);this.setState({configMap:t,ratioMetrics:r,display:T.getMetrics,ratioMetricsState:d,selectedType:void 0,newMetric:void 0,formSubmitted:void 0})}else console.log("uniqueName:",e),console.log("allRequiredFieldsPresent:",a)}e.preventDefault()},this.editMetricHandler=e=>{console.log("click submitted"),this.setState({formSubmitted:!0});const{selectedType:t}=this.state;let{configMap:i,counterMetrics:r,ratioMetrics:a,selectedMetricName:o,newMetric:s}=this.state;if(t===b.counter){console.log("edited counter metric config:",s);const e=!r.filter((e=>e.name!==o)).some((e=>e.name===s.name)),t=g.every((e=>s[e]));if(t&&e){const e={};Object.entries(s).forEach((([t,i])=>{O.find((e=>e.name===t)).type===S.input?i.length>0&&(e[t]=i):e[t]=i})),r=r.filter((e=>e.name!==o)),r.push(e),a.forEach((e=>{e.numerator===o&&(e.numerator=s.name),e.denominator===o&&(e.denominator=s.name)}));const t=(0,n.safeDump)(r),c=(0,n.safeDump)(a);i.data["counter_metrics.yaml"]=t,i.data["ratio_metrics.yaml"]=c,(0,p.Fq)(i,this.args);const l=q(r.map((e=>e.name))),d=N.find((e=>"numerator"===e.name)),m=N.find((e=>"denominator"===e.name));d.dropdownOptions=l,m.dropdownOptions=l;const{counterMetricsState:u}=this.generateMetricsStates(r,a);this.setState({configMap:i,counterMetrics:r,display:T.getMetrics,counterMetricsState:u,selectedMetricName:void 0,selectedType:void 0,newMetric:void 0,formSubmitted:void 0})}else console.log("uniqueName:",e),console.log("allRequiredFieldsPresent:",t)}else{console.log("edited ratio metric config:",s);const e=!a.filter((e=>e.name!==o)).some((e=>e.name===s.name)),t=y.every((e=>s[e]));if(t&&e){const e={};Object.entries(s).forEach((([t,i])=>{N.find((e=>e.name===t)).type===S.input?i.length>0&&(e[t]=i):e[t]=i})),a=a.filter((e=>e.name!==o)),a.push(e);const t=(0,n.safeDump)(a);i.data["ratio_metrics.yaml"]=t,(0,p.Fq)(i,this.args);const c=q(r.map((e=>e.name))),l=N.find((e=>"numerator"===e.name)),d=N.find((e=>"denominator"===e.name));l.dropdownOptions=c,d.dropdownOptions=c;const{ratioMetricsState:m}=this.generateMetricsStates(r,a);this.setState({configMap:i,ratioMetrics:a,display:T.getMetrics,ratioMetricsState:m,selectedMetricName:void 0,selectedType:void 0,newMetric:void 0,formSubmitted:void 0})}else console.log("uniqueName:",e),console.log("allRequiredFieldsPresent:",t)}e.preventDefault()},this.deleteMetricHandler=(e,t)=>{const i=Object.assign({},this.state);t===b.counter?f(this.state.rawConfigMap,e,t,this.args)&&(i.counterMetricsState[e].isDeleted=!0,this.state.counterMetricsState[e].alsoDelete.forEach((e=>{f(this.state.rawConfigMap,e,b.ratio,this.args)&&(i.ratioMetricsState[e].isDeleted=!0)}))):f(this.state.rawConfigMap,e,t,this.args)&&(i.ratioMetricsState[e].isDeleted=!0),this.setState(i)},this.restoreMetricHandler=(e,t)=>{const{counterMetricsState:i,ratioMetricsState:r}=this.state,n=Object.assign({},this.state);t===b.counter?M(this.state.rawConfigMap,i[e].details,t,this.args)&&(n.counterMetricsState[e].isDeleted=!1):M(this.state.rawConfigMap,r[e].details,t,this.args)&&(n.ratioMetricsState[e].isDeleted=!1,r[e].alsoRestore.forEach((e=>{i[e].isDeleted&&M(this.state.rawConfigMap,i[e].details,b.counter,this.args)&&(n.counterMetricsState[e].isDeleted=!1)}))),this.setState(n)},this.updateAttribute=(e,t)=>{const i=t.type===S.input?e.target.value:t.dropdownOptions.find((t=>t.printableOption===e.target.value)).value,r={};r[t.name]=i,this.setState({newMetric:Object.assign(Object.assign({},this.state.newMetric),r)})},this.renderTableTitle=(e,t)=>r.createElement("div",null,e," ",r.createElement(a.PJ,{icon:"Add",onClick:()=>this.displayAddMetric(t),className:"clickableicon"})),this.renderMetricDetails=(e,t)=>{const i=this.getInitialRowsFromObjectKeys(e);return r.createElement(o.X,{className:"kui--table-like-wrapper"},r.createElement(s.p,{className:"innertable"},i.map((i=>{const n=t===b.counter?O.find((e=>e.name===i.id)):N.find((e=>e.name===i.id));if(n.type===S.dropdown){const t=n.dropdownOptions.find((t=>t.value===e[i.id]));return r.createElement(c.Tr,{key:i.id},r.createElement(l.Td,null,i.id),r.createElement(l.Td,null,t.printableOption))}return r.createElement(c.Tr,{key:i.id},r.createElement(l.Td,null,i.id),r.createElement(l.Td,null,e[i.id]))}))))},this.renderMetricTable=(e,t,i)=>{const n=this.getInitialRowsFromObjectKeys(e);return r.createElement(o.X,{className:"kui--table-like-wrapper"},r.createElement(d.Y,null,this.renderTableTitle(i,t)),r.createElement(s.p,{isExpanded:!0},n.map((i=>r.createElement(r.Fragment,{key:i.id},r.createElement(c.Tr,{"aria-label":"Information Unavailable",isExpanded:!0},r.createElement(l.Td,null,i.id),r.createElement(l.Td,null,r.createElement("div",{className:"clickableicon",onClick:()=>{e[i.id].custom&&this.displayEditMetric(i.id,t)}},r.createElement(a.PJ,{icon:"Edit"}),e[i.id].custom?null:this.renderIter8ImmutableMetricWarning("edit"))),r.createElement(l.Td,{className:"width20"},r.createElement("div",null,e[i.id].isDeleted?r.createElement("div",null,this.renderDeleteWarning(i.id,t)):r.createElement("div",{className:"clickableicon",onClick:()=>{e[i.id].custom&&this.deleteMetricHandler(i.id,t)}},r.createElement(a.PJ,{icon:"Trash"}),t===b.counter&&e[i.id].custom&&e[i.id].alsoDelete.length>0?r.createElement("div",{className:"warningtext"},"Warning: Will also delete ",e[i.id].alsoDelete.join(", ")):null,e[i.id].custom?null:this.renderIter8ImmutableMetricWarning("delete"))))),i.isExpanded&&r.createElement(c.Tr,{colSpan:4,isExpanded:!0},r.createElement("div",null,this.renderMetricDetails(e[i.id].details,t))))))))},this.renderAttributeForm=(e,t)=>{const{newMetric:i,formSubmitted:n}=this.state;if(e.type===S.input){const a=!(i[e.name]||!n||!e.required)||!!(e.invalidChecks&&e.invalidChecks[t]&&e.invalidChecks[t].check)&&e.invalidChecks[t].check(i[e.name],this.state),o=i[e.name]?e.invalidChecks&&e.invalidChecks[t]&&e.invalidChecks[t].invalidText?e.invalidChecks[t].invalidText:"":"This is a required attribute",s=e.name,c=e.printableName;return r.createElement(m.FormGroup,{key:e.name,label:c,fieldId:`get-metrics-${c}-${s}`,helperText:e.description,helperTextInvalid:o,validated:a?"error":"default",isRequired:e.required},r.createElement(m.TextInput,{id:s,value:i[e.name],onChange:t=>this.updateAttribute(t,e)}))}{const a=e.dropdownOptions.find((t=>t.value===i[e.name])),o=a?a.printableOption:i[e.name],s=!(i[e.name]||!n||!e.required)||!!(e.invalidChecks&&e.invalidChecks[t]&&e.invalidChecks[t].check)&&e.invalidChecks[t].check(i[e.name],this.state),c=i[e.name]?e.invalidChecks&&e.invalidChecks[t]&&e.invalidChecks[t].invalidText?e.invalidChecks[t].invalidText:"":"This is a required attribute. An option must be selected.",l=e.name,d=e.printableName;return r.createElement(m.FormGroup,{key:e.name,label:d,fieldId:`get-metrics-select-${d}-${l}`,helperText:e.description,helperTextInvalid:c,validated:s?"error":"default",isRequired:e.required},r.createElement(m.FormSelect,{id:l,value:o,onChange:t=>this.updateAttribute(t,e)},(()=>{if(e.noDefaultDropdownOptionPlaceholder)return r.createElement(m.FormSelectOption,{key:"default",label:e.noDefaultDropdownOptionPlaceholder,value:e.noDefaultDropdownOptionPlaceholder})})(),e.dropdownOptions.map((e=>r.createElement(m.FormSelectOption,{key:e.printableOption,label:e.printableOption,value:e.printableOption})))))}},this.renderMetricForm=(e,t,i)=>r.createElement("div",null,r.createElement(m.Form,{onSubmit:t},(()=>e===b.counter?O.map((e=>this.renderAttributeForm(e,i))):N.map((e=>this.renderAttributeForm(e,i))))(),r.createElement(m.ActionGroup,null,r.createElement(a.zx,{kind:"primary",type:"submit"},i===w.add?e===b.counter?"Create counter metric":"Create ratio metric":e===b.counter?"Edit counter metric":"Edit ratio metric"),r.createElement(a.zx,{className:"small-left-pad",kind:"link",type:"button",onClick:this.displayGetMetrics},"Cancel")))),this.render=()=>{const{display:e,selectedType:t,counterMetricsState:i,ratioMetricsState:n,errorString:o}=this.state;switch(e){case T.getMetrics:return r.createElement("div",{className:"pageStyle"},this.renderMetricTable(i,b.counter,"Counter Metrics"),this.renderMetricTable(n,b.ratio,"Ratio Metrics"),r.createElement("div",{className:"padding-content"},r.createElement(a.zx,{kind:"primary",onClick:this.refreshState},"Refresh")));case T.addMetric:return r.createElement("div",{className:"padding-content"},(()=>this.renderMetricForm(t,this.addMetricHandler,w.add))());case T.editMetric:return r.createElement("div",{className:"padding-content"},(()=>this.renderMetricForm(t,this.editMetricHandler,w.edit))());case T.error:return r.createElement(u,{errorString:o});default:return r.createElement("div",null,"Cannot determine proper display mode")}},this.args=e;try{this.state={configMap:null,rawConfigMap:{},counterMetrics:[],ratioMetrics:[],counterMetricNames:[],ratioMetricNames:[],counterMetricsState:{},ratioMetricsState:{},display:T.getMetrics,formSubmitted:!1,errorString:"None"},this.getConfigMap()}catch(e){this.state={configMap:void 0,rawConfigMap:void 0,counterMetrics:void 0,ratioMetrics:void 0,counterMetricNames:void 0,ratioMetricNames:void 0,counterMetricsState:void 0,ratioMetricsState:void 0,formSubmitted:void 0,display:T.getMetrics,errorString:e}}}getConfigMap(){setTimeout((()=>v(this,void 0,void 0,(function*(){const[e]=yield Promise.all([(0,h.IA)(this.args)]);this.setState({rawConfigMap:e}),this.constructorHelper()}))))}}}}]);