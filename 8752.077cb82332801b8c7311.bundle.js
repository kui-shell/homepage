(self.webpackChunkkui_shell=self.webpackChunkkui_shell||[]).push([[8752],{35227:(e,t,n)=>{"use strict";function a(e){const t=e.find((e=>"Succeeded"===e.type));return t&&(!0===t.status||!1!==t.status&&/true/i.test(t.status))}n.d(t,{Z:()=>a})},64930:(e,t,n)=>{"use strict";n.d(t,{h:()=>s,A:()=>i});var a=function(e,t,n,a){return new(n||(n=Promise))((function(s,i){function l(e){try{d(a.next(e))}catch(e){i(e)}}function o(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,o)}d((a=a.apply(e,t||[])).next())}))};function s(e,t){return e.REPL.qexec(`kubectl get Pipeline ${t.spec.pipelineRef.name} -o json`).catch((e=>{if(404!==e.code)throw e}))}function i(e){return a(this,void 0,void 0,(function*(){return(yield e.REPL.qexec("kubectl get Task -o json")).items}))}},98752:(e,t,n)=>{"use strict";n.r(t),n.d(t,{render:()=>p,traceView:()=>f,default:()=>h});var a=n(11227),s=n.n(a),i=n(73258),l=n.n(i),o=n(51173),d=n(35227),c=n(64930),r=function(e,t,n,a){return new(n||(n=Promise))((function(s,i){function l(e){try{d(a.next(e))}catch(e){i(e)}}function o(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,o)}d((a=a.apply(e,t||[])).next())}))};const u=(0,o.i18n)("plugin-kubectl","tekton"),m=s()("plugins/tekton/models/modes/trace"),p=(e,t,n,a={})=>{const{noCrop:s=!1,showStart:i=!1,showTimeline:d=!0}=a;m("trace",t);const c=document.createElement("div");n.appendChild(c),c.className="legend-trace legend-list",c.innerHTML="<div class='legend-stripe'><div class='legend-entry' data-legend-type='queueing-delays' data-balloon='The time this activation waited for free execution resources' data-balloon-pos='left'>Queueing Delays<div class='legend-icon is-waitTime'></div></div><div class='legend-entry' data-legend-type='container-initialization' data-balloon='The \"cold start time\", i.e. time spent initializing a container' data-balloon-pos='left'>Container Initialization<div class='legend-icon is-initTime'></div></div><div class='legend-entry' data-legend-type='execution-time' data-balloon='The time this activation spent executing your code' data-balloon-pos='left'>Execution Time<div class='legend-icon is-runTime'></div></div><div class='legend-entry' data-legend-type='failures' data-balloon='The activation failed to complete' data-balloon-pos='left'>Failures<div class='legend-icon is-success-false'></div></div></div>";const r=document.createElement("table");r.className="log-lines log-lines-loose",n.appendChild(r);const u=t[0].start,p=t.reduce(((e,t)=>Math.max(e,t.end||t.start+1)),0),f=Math.max(1,p-u,p-u),h=new Array(t.length).fill(0),g=(e,t)=>(e-u-h[t])/(f-0);t.forEach(((e,n)=>{const a=!e.end||(void 0!==e.statusCode?0===e.statusCode:e.response&&e.response.success),u=r.insertRow(-1);u.className="log-line entity",u.classList.add("activation"),u.setAttribute("data-name",e.name),0===n&&u.classList.add("log-line-root");const m=()=>u.insertCell(-1),f=m(),h=document.createElement("span");h.className="clickable",f.appendChild(h),f.className="log-field",s&&f.classList.add("full-width"),h.innerText=e.activationId,f.setAttribute("data-activation-id",f.innerText);const v=m(),y=document.createElement("span");v.className="slightly-deemphasize log-field entity-name",y.className="clickable",y.innerText=e.name,v.appendChild(y);const T=m();T.className="somewhat-smaller-text log-field log-field-right-align duration-field",T.classList.add(a?"green-text":"red-text"),e.end?T.innerText=l()(e.end-e.start):T.innerText=l()(1);if(d){const t=m();(0,o.empty)(t);t.className="log-field log-line-bar-field";const s=document.createElement("div");s.style.position="absolute",s.classList.add("log-line-bar"),s.classList.add(`is-success-${a}`);const i=g(e.start+0,n),d=g(0===n?p:e.end||e.start+0+1,n),r=d-i,u=d>.9?"left":"right";let f,h;s.style.left=100*i+"%",s.style.width=100*r+"%",s.setAttribute("data-balloon",l()(e.end?e.end-e.start-0:0)),s.setAttribute("data-balloon-pos",u),s.onmouseover=()=>c.setAttribute("data-hover-type",a?"execution-time":"failures"),s.onmouseout=()=>c.removeAttribute("data-hover-type"),"right"===u?(t.appendChild(s),f&&t.appendChild(f),h&&t.appendChild(h)):(h&&t.appendChild(h),f&&t.appendChild(f),t.appendChild(s))}if(i){const a=m(),s=document.createElement("span"),i=t[n-1],l=0,d=i&&i.start-l,c=(0,o.prettyPrintTime)(e.start-0,"short",d);a.className="somewhat-smaller-text lighter-text log-field log-field-right-align start-time-field timestamp-like",a.appendChild(s),"string"==typeof c?s.innerText=c:((0,o.empty)(s),s.appendChild(c))}}))};const f=(e,t,n,a)=>{const s=document.createElement("div");s.classList.add("padding-content","repl-result"),s.style.flex="1",s.style.display="flex",s.style.flexDirection="column",s.style.overflowX="hidden";const i=function(e){const t=e&&e.status&&e.status.startTime&&new Date(e.status.startTime),n=e&&e.status&&e.status.completionTime&&new Date(e.status.completionTime),a=t&&n&&n.getTime()-t.getTime();return{activationId:e.metadata.name,name:e.spec.pipelineRef.name,start:t&&t.getTime(),end:n&&n.getTime(),duration:a,response:{success:(0,d.Z)(e.status.conditions)}}}(t);p(e,[i].concat(function(e,t,n){const a=e&&e.status.taskRuns,{taskRefName2Task:s}=function(e,t){const n=t.filter((e=>"Task"===e.kind)).reduce(((e,t)=>(e[t.metadata.name]=t,e)),{});return{taskRefName2Task:e.spec.tasks.reduce(((e,t)=>(e[t.name]=n[t.taskRef.name],e)),{})}}(t,n),i=Object.keys(a||[]).reduce(((e,t)=>{const n=a[t],i=n.pipelineTaskName;return s[i]?n.status.steps.forEach((t=>{const a=new Date(t.terminated.startedAt).getTime(),s=new Date(t.terminated.finishedAt).getTime(),i="Error"!==t.terminated.reason;e.push({activationId:n.pipelineTaskName,name:t.name,start:a,end:s,duration:s-a,response:{success:i}})})):console.error("!! task not found",i,s),e}),[]);return i.sort(((e,t)=>e.start-t.start)),i}(t,n,a)),s);return{type:"custom",isEntity:!0,name:t.metadata.name,packageName:t.metadata.namespace,prettyType:"PipelineRun",duration:i.duration,badges:["Tekton"],content:s}},h={mode:"trace",label:u("trace"),content:(e,t)=>r(void 0,void 0,void 0,(function*(){const[n,a]=yield Promise.all([(0,c.h)(e,t),(0,c.A)(e)]);return f(e,t,n,a)})),defaultMode:!0}}}]);