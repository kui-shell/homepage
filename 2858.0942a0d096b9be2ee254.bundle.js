(self.webpackChunkkui_shell=self.webpackChunkkui_shell||[]).push([[2858,1758,2383,1032,9026],{63432:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(53156);const i=(e,t)=>"Event"===e&&"wide"!==(0,o.QI)(t)?["Object","Reason","Message","Last Seen"]:void 0},56619:(e,t,n)=>{"use strict";n.d(t,{Oq:()=>p,ZP:()=>f});var o=n(39832),i=n.n(o),r=n(51173),s=n(54476),a=n(53156),c=n(21274),u=n(67808);function l(e){const t=e.match(/custom-columns=(.+)/);if(!t)throw new Error("Invalid custom column specification"+e);return t[1].split(/,/).map((e=>{const t=e.indexOf(":");if(t>=0){const n=e.slice(0,t),o=e.slice(t+1);if(n&&o)return{key:n,query:i().parse("$"+o)}}throw new Error("Invalid custom column: "+e)})).filter((e=>e))}function d(e,t,n,o,c){const l=c.map((({key:t,query:n})=>{const r=i().value(e,n);return{key:t,value:r,tag:u.Qi[t]||u.VH[o]&&u.VH[o][t],outerCSS:u.jT[t],css:[u.RA[t],u.O2[r],/Ready/i.test(t)?(0,u.QW)(r):"",/failed/i.test(r)?s.Z.Red:""].join(" ")}}));return{key:l[0].key,rowKey:(0,u.Rx)(e.metadata,o),name:l[0].value,attributes:l.slice(1),onclick:(0,a.QG)(t,`${n} get ${o} ${(0,r.encodeComponent)(e.metadata.name)} -o yaml -n ${e.metadata.namespace}`)}}function p(e,t,n,o,i){const r=l(i),s={name:r[0].key,attributes:r.slice(1).map((e=>({key:e.key,value:e.key})))},a=[d(e,t,n,o,r)];return(0,u.jU)({header:s,body:a})}function f(e,t,n,o,i){const r=l(i),s={name:r[0].key,attributes:r.slice(1).map((e=>({key:e.key,value:e.key})))},a=(0,c.oe)(e)?e.items.map((e=>d(e,t,n,o,r))):[d(e,t,n,o,r)];return(0,u.jU)({header:s,body:a,resourceVersion:e.metadata.resourceVersion})}},96322:(e,t,n)=>{"use strict";n.d(t,{a:()=>c,Z:()=>u});var o=n(51173),i=n(6394),r=n(21274),s=n(65402),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};function c(e){try{const t=JSON.parse(e);return(0,r.Cb)(t)?t:e}catch(t){return e}}function u(e,t,n,u,l=!1){return a(this,void 0,void 0,(function*(){const d=yield Promise.all(e.map((e=>a(this,void 0,void 0,(function*(){let o=(0,s.Q)(e)?c(e.error):(0,r.Cb)(e)?e:void 0;if(o){if((0,r.Cb)(o)){if(404===o.code&&"Namespace"!==n){const e=t(!1),a=t(!0)+"?limit=1",c={headers:i.o},[l,d]=yield Promise.all([(0,s.dc)(u,e,c).then((e=>e[0])).catch((e=>JSON.parse(e.message))),(0,s.dc)(u,a,c).then((e=>e[0])).catch((e=>JSON.parse(e.message)))]);if((0,r.Cb)(d)){const e=new Error(`error: the server doesn't have a resource type "${n}"`);return e.code=404,e}(0,r.Cb)(l)&&(o=l)}const e=new Error(`Error from server (${o.reason}): ${o.message}`);return e.code=o.code,e}{const e=new Error(o);return e.code=500,e}}return e})))));if(!l&&d.every(o.isCodedError)){const e=new Error(d.map((e=>e.message)).join("\n"));throw e.code=d[0].code,e}{const e={errors:[],ok:[],okIndices:[],errorIndices:[]};return d.reduce(((e,t,n)=>((0,o.isCodedError)(t)?(e.errors.push(t),e.errorIndices.push(n)):(e.ok.push(t),e.okIndices.push(n)),e)),e)}}))}},44593:(e,t,n)=>{"use strict";n.d(t,{hC:()=>g,ZP:()=>b});var o=n(51173),i=n(71074),r=n(65402),s=n(79895),a=n(67808),c=n(31343),u=n(53156),l=n(63432),d=n(71217),p=n(96322),f=n(56619),m=n(6394),h=n(21274),v=n(48764).Buffer,y=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};function g(e,t,n,s,c,l,h=!1,g){return y(this,void 0,void 0,(function*(){const{kind:y}=s,b={explainedKind:s,names:n,namespace:t},k=yield(0,d.D)(e,t,l,s),w=0===n.length?k(!0,!0):n.map(k.bind(void 0,!0,!0)).join(","),x=c||"default",O=(0,u.LJ)(x);if("wide"===x||"default"===x||O){const n=yield(0,r.dc)(l.REPL,w,{headers:O?m.o:m.X,returnErrors:!0}),{errors:s,ok:c}=yield(0,p.Z)(n,k,y,l.REPL);if(O){const t=c.reduce(((e,t)=>{const n=v.isBuffer(t)||"string"==typeof t?JSON.parse(t.toString()):t;return e?(e.items=e.items.concat(n.items),e):n}),void 0);t.isKubeResource=!0;const n=(0,f.ZP)(t,l,e,y,x);return(0,u.CC)(l)?(0,i.ZP)(e,l,y,b,n,k):n}{const n=c.reduce(((e,t)=>{const n=v.isBuffer(t)||"string"==typeof t?JSON.parse(t.toString()):t;return e?(e.rows=e.rows.concat(n.rows),e):n}),void 0);if(l.execOptions.type===o.ExecType.TopLevel&&n&&0===n.rows.length&&!(0,u.CC)(l))return`No resources found in **${t}** namespace.`;try{const t=(0,a.k8)(yield(0,a.hb)(n,y,l,e,h,g),s.map((e=>e.message)).join("\n"));return(0,u.CC)(l)?(0,i.ZP)(e,l,y,b,t,k):t}catch(e){throw console.error("error formatting table",e),new Error("Internal Error")}}}}))}function b(e,t){return y(this,void 0,void 0,(function*(){const o=(0,u.D_)(e),i=(0,u.QI)(e),a=(0,s.fY)(e),f=e.argvNoOptions.indexOf("get")+1,m=e.argvNoOptions.slice(f+1),b=t?yield t:{kind:void 0,version:void 0,isClusterScoped:!1};return function(e,t,o,i,s,a){return y(this,void 0,void 0,(function*(){const f=(0,u.$L)(a),m=(0,u.EC)(s)||"name"===s;if(f&&!m)return(0,c.$)(a,"get",e,void 0,void 0,void 0,(0,u.CC)(a));if((0,u.cV)(a))return g(e,t,o,i,s,a,void 0,(0,l.Z)(i.kind,a));if(!(0,u.cV)(a)&&!f&&void 0===a.parsedOptions.kubeconfig&&void 0===a.parsedOptions.context&&m){const c=yield(0,d.D)(e,t,a,i),u=0===o.length?c(!0,!0):o.map(c.bind(void 0,!0,!0)).join(",");let l;try{l=(yield(0,r.dc)(a.REPL,u,{headers:{accept:"application/json"}}))[0]}catch(e){if(l=(0,p.a)(e.message),!(0,h.Cb)(l))throw e}if((0,h.Cb)(l)){const e=new Error(`Error from server (${l.reason}): ${l.message}`);throw e.code=l.code,e}if("name"!==s){if("yaml"===s){const{safeDump:e}=yield n.e(3320).then(n.t.bind(n,93320,23));return{content:{code:0,stderr:"",stdout:e(v.isBuffer(l)||"string"==typeof l?JSON.parse(l.toString()):l),wasSentToPty:!1}}}return{content:{code:0,stderr:"",stdout:v.isBuffer(l)||"string"==typeof l?l.toString():JSON.stringify(l),wasSentToPty:!1}}}try{return{content:{code:0,stderr:"",stdout:(v.isBuffer(l)||"string"==typeof l?JSON.parse(l.toString()):l).items.map((e=>e.metadata.name)).join("\n"),wasSentToPty:!1}}}catch(e){throw new Error(l.toString())}}}))}(a,yield o,m,b,i,e)}))}},6394:(e,t,n)=>{"use strict";n.d(t,{o:()=>o,X:()=>i});const o={accept:"application/json"},i={accept:"application/json;as=Table;g=meta.k8s.io;v=v1"}},38957:(e,t,n)=>{"use strict";n.d(t,{Z:()=>N});var o=n(11227),i=n.n(o),r=n(26470),s=n(51173),a=n(44593),c=n(63432),u=n(54476);const l="Kind",d="Status",p={name:"Name",attributes:[{key:l,value:l},{key:d,value:d}]};function f(e,t,n,o,i,r=[]){const s={name:e,attributes:r.concat([{key:l,value:t},{key:d,value:n,tag:"badge",css:o}])};return i?Object.assign({},i,s):s}function m(e,t){return e.metadata&&e.metadata.labels?e.metadata.labels[t]:void 0}function h(e,t){if(e.spec&&e.spec.selector&&e.spec.selector.matchLabels)return e.spec.selector.matchLabels[t]}function v(e,t){const n=e.name,o=e.attributes.findIndex((e=>"badge"===e.tag)),i=o>=0?e.attributes[o].value:"Unknown",r=o>=0?(0,u.o)(e.attributes[o].css):u.Z.Gray,s=[],a=e.object?m(e.object,"tier")||m(e.object,"app.kubernetes.io/component")||h(e.object,"tier"):"";s.push({key:"Tier",value:a});const c=e.object?m(e.object,"app")||m(e.object,"app.kubernetes.io/name")||h(e.object,"app"):"";return s.push({key:"Application",value:c}),f(n,t,i,r,e,s)}function y(e,t){return e.map(((e,n)=>v(e,Array.isArray(t)?t[n]:t)))}function g(e,t){return{header:p,body:e.map((e=>function(e,t){return f(e,t,"Offline",u.Z.Red)}(e,t)))}}var b=n(71217),k=n(71074),w=n(31343),x=n(35501),O=n(60965),S=n(79895),$=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const E=i()("plugin-kubectl/controller/client/direct/status");function C(e,t){return t?e.body.reduce(((e,n)=>(0,w.o)(n,t)?e:e+1),0):e.body.length}class R{constructor(e,t,n,o,i,r,s,a,c,u=!1){this.drilldownCommand=e,this.args=t,this.kind=n,this.resourceVersion=o,this.formatUrl=i,this.groups=r,this.finalState=s,this.initialRowKeys=a,this.nNotReady=c,this.monitorEvents=u,this.nNotDone=0}abort(){E("abort requested",this.watchers.length),this.watchers.forEach((e=>{e&&e.abort()}))}init(e){this.pusher=e,this.watchers=this.resourceVersion.map(((e,t)=>{if(e&&0!==this.nNotReady[t]){const n=new k.NC(this.drilldownCommand,this.args,this.kind[t].kind,e,this.formatUrl[t],this.groups[t],this.finalState,this.initialRowKeys[t],this.nNotReady[t],this.monitorEvents,!0);return this.nNotReady[t]>0&&this.nNotDone++,n}})),this.watchers.forEach(((e,t)=>{e&&e.init(this.myPusher(t))}))}myPusher(e){const t={header:()=>{},update:(t,n,o)=>{E("update of unified row",t.rowKey,this.kind[e].kind,t.attributes[1].value),this.pusher.update(v(t,this.kind[e].kind),n,o)},done:()=>{E("one sub-table is done",this.kind[e],this.nNotDone),--this.nNotDone<=0&&(E("all sub-tables are done"),this.pusher.done())}};return Object.assign({},this.pusher,t)}}function N(e,t,n,o=(0,S.fY)(e),i,u=!0){return $(this,void 0,void 0,(function*(){if(0===t.length)return;const l={REPL:e.REPL,execOptions:{type:e.execOptions.type},parsedOptions:{}},d=yield Promise.all(t.map(((t,i)=>$(this,void 0,void 0,(function*(){return{idx:i,table:yield(0,a.hC)(o,t.namespace,t.names,t.explainedKind,"default",l,!0,(0,c.Z)(t.explainedKind.kind,e)).then((e=>"string"==typeof e?g(t.names,t.explainedKind.kind):e)).catch((e=>{if(404===e.code)return u&&n!==O.d.OfflineLike?{body:[]}:g(t.names,t.explainedKind.kind)}))}})))));if(d.length>0){if(1===t.length&&1===d.length){const e=u?C(d[0].table,n):0;return 0===e?(E("special case: single-group watching, all-ready all ready!",e,t[0]),"Namespace"===t[0].explainedKind.kind&&(0,x.xf)("CreateOrDeleteNamespace"),d[0].table):(E("special case: single-group watching with some not yet ready",e,t[0]),(0,k.ZP)(o,l,t[0].explainedKind.kind,t[0],d[0].table,(0,b.D)(o,t[0].namespace,l,t[0].explainedKind),n,d[0].table.body.map((e=>({rowKey:e.rowKey,isReady:(0,w.o)(e,n)}))),e,!0,!0))}const a=i?(0,r.basename)(i):void 0,c=t.every((e=>e.namespace===t[0].namespace))?[{label:t[0].namespace}]:void 0,p=void 0,f=y([].concat(...d.map((e=>e.table.body))),(0,s.flatten)(t.map((e=>Array(e.names.length).fill(0).map((()=>e.explainedKind.kind)))))),m={title:a,breadcrumbs:u?void 0:c,header:p,body:f};if(u){const i=new R(o,e,d.map((e=>t[e.idx].explainedKind)),d.map((e=>e.table.resourceVersion)),yield Promise.all(d.map((e=>{const n=t[e.idx];return(0,b.D)(o,n.namespace,l,n.explainedKind)}))),t,n,d.map((e=>e.table.body.map((e=>({rowKey:e.rowKey,isReady:(0,w.o)(e,n)}))))),d.map((e=>C(e.table,n))),!0);return Object.assign(m,{watch:i})}return m}throw new Error("nothing to watch")}))}},71217:(e,t,n)=>{"use strict";n.d(t,{D:()=>c,a:()=>u});var o=n(79895),i=n(53156),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};function s(e){return"v1"===e?"api/v1":`apis/${encodeURIComponent(e)}`}function a(e){return`/${encodeURIComponent(e.toLowerCase()+(/s$/.test(e)?"":"s"))}`}function c(e,t,{parsedOptions:n},{kind:o,version:r,isClusterScoped:c}){const u=a(o),l=s(r);t||(console.error('Internal oddity with namespace, falling back on "default", and was given:',t),t="default");const d=(0,i.Dk)(n)||"Namespace"===o||c?"":`/namespaces/${encodeURIComponent(t)}`,p=[],f=(0,i.id)({parsedOptions:n});if(f){const e=e=>p.push(`labelSelector=${encodeURIComponent(e)}`);Array.isArray(f)?f.forEach(e):e(f)}return n["field-selector"]&&"string"==typeof n["field-selector"]&&p.push(`fieldSelector=${encodeURIComponent(n["field-selector"])}`),"number"==typeof n.limit&&p.push(`limit=${n.limit}`),(t=!1,n=!1,o,i)=>{const r=i&&i.version?s(i.version):l,c=i&&i.kind?a(i.kind):u;return`${"oc"===e?"openshift":"kubernetes"}:///${r}${d}${t?c:""}${o?`/${encodeURIComponent(o)}`:""}${n&&0!==p.length?"?"+p.join("&"):""}`}}function u(e,t){return r(this,void 0,void 0,(function*(){return c((0,o.fY)(e),yield(0,i.D_)(e),e,t)}))}},71074:(e,t,n)=>{"use strict";n.d(t,{NC:()=>g,ZP:()=>b});var o=n(11227),i=n.n(o);function r(e,t,n){const{explainedKind:o,names:i}=e,r=o.kind.toLowerCase()===t.toLowerCase(),s=0===i.length,a=i.includes(n);return r&&(a||s)}var s=n(63432),a=n(56619),c=n(6394),u=n(60965),l=n(67808),d=n(65402),p=n(21274),f=n(31343),m=n(35501),h=n(53156),v=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const y=i()("plugin-kubectl/client/direct/watch");class g extends class{constructor(){this.jobs=[]}xon(){this.jobs.forEach((e=>e.xon()))}xoff(){this.jobs.forEach((e=>e.xoff()))}abort(){y("abort requested",this.jobs.length,this.jobs),this.jobs.forEach((e=>e.abort()))}onExit(e){y("job exited",e)}onReady(){y("job is ready")}}{constructor(e,t,n,o,i,r,s,a,c,u=!0,l=!1){super(),this.drilldownCommand=e,this.args=t,this.kind=n,this.resourceVersion=o,this.formatUrl=i,this.group=r,this.finalState=s,this.nNotReady=c,this.monitorEvents=u,this.needsStatusColumn=l,this.alreadySentHeaders=!1,s&&(this.readyDebouncer=a?a.reduce(((e,{rowKey:t,isReady:n})=>(e[t]=n,e)),{}):void 0)}init(e){return v(this,void 0,void 0,(function*(){this.pusher=e,yield Promise.all([this.initBodyUpdates(),this.monitorEvents&&"Event"!==this.kind?this.initFooterUpdates():Promise.resolve()])}))}isCustomColumns(){return(0,h.LJ)((0,h.QI)(this.args))}initBodyUpdates(){const e=this.formatUrl(!0)+`?watch=true&resourceVersion=${this.resourceVersion.toString()}`,t=this.onInitForBodyUpdates.bind(this);return(0,d.Cg)(this.args,e,this.mgmt(t),this.isCustomColumns()?c.o:c.X)}formatEventUrl(e){const t=`fieldSelector=involvedObject.kind=${this.kind}`;return this.formatUrl(!0,void 0,void 0,{version:"v1",kind:"Event"})+`?${t}`+(e?`&watch=true&resourceVersion=${e.resourceVersion.toString()}`:"")}filterFooterRows(e,t,n){const o=e.rows.filter((e=>{const t=e.cells[n];if("string"==typeof t){const e=t.split("/")[0],n=t.split("/")[1];return r(this.group,e,n)}})),i=this.lastFooterEvents;return this.lastFooterEvents=o.reduce(((e,n)=>(e[n.cells[t]]=!0,e)),{}),i?o.filter((e=>!i[e.cells[t]])):o}formatFooter(e){if(this.footerColumnDefinitions){const{lastSeenColumnIdx:t,objectColumnIdx:n,messageColumnIdx:o,nameColumnIdx:i}=this.footerColumnDefinitions;return this.filterFooterRows(e,i,n).map((e=>{const r=e.cells[t],s=e.cells[n],a=e.cells[o],c=e.cells[i];return`[[${r}]](${`#kuiexec?command=${encodeURIComponent((0,h.QG)(this.args,`kubectl get event ${c} -o yaml`))}`}) **${s}**: ${a}`}))}console.error("Dropping footer update, due to missing column definitions")}initFooterColumnDefinitions(e){const t=e.reduce(((e,t,n)=>("Last Seen"===t.name?e.lastSeenColumnIdx=n:"Object"===t.name?e.objectColumnIdx=n:"Message"===t.name?e.messageColumnIdx=n:"Name"===t.name&&(e.nameColumnIdx=n),e)),{lastSeenColumnIdx:-1,objectColumnIdx:-1,messageColumnIdx:-1,nameColumnIdx:-1}),{lastSeenColumnIdx:n,objectColumnIdx:o,messageColumnIdx:i,nameColumnIdx:r}=t;n<0?console.error("Unable to process footer column definitions, due to missing Last Seen column",e):o<0?console.error("Unable to process footer column definitions, due to missing Object column",e):i<0?console.error("Unable to process footer column definitions, due to missing Message column",e):r<0?console.error("Unable to process footer column definitions, due to missing Name column",e):this.footerColumnDefinitions=t}onEventData(e){!this.footerColumnDefinitions&&e.object.columnDefinitions&&this.initFooterColumnDefinitions(e.object.columnDefinitions),this.pusher.footer(this.formatFooter(e.object))}initFooterUpdates(){return v(this,void 0,void 0,(function*(){const e=(yield(0,d.dc)(this.args.REPL,this.formatEventUrl(),{headers:c.X}))[0];if((0,p.iN)(e)){this.onEventData({object:e});const t=this.formatEventUrl({resourceVersion:e.metadata.resourceVersion});return(0,d.Cg)(this.args,t,{onInit:e=>(this.jobs.push(e),this.onEventData.bind(this))},c.X)}console.error("Unexpected response from event query",this.formatEventUrl(),e)}))}mgmt(e){return{onInit:e,onReady:this.onReady.bind(this),onExit:this.onExit.bind(this)}}onInitForBodyUpdates(e){return this.jobs.push(e),this.onData.bind(this)}onData(e){if(!e.object.columnDefinitions&&this.bodyColumnDefinitions&&(e.object.columnDefinitions=this.bodyColumnDefinitions),!e.object.columnDefinitions&&!this.isCustomColumns())return void console.error("Missing column definitions in update",e);const t=(0,h.LJ)((0,h.QI)(this.args));let n=!this.alreadySentHeaders;t||(this.bodyColumnDefinitions||(n=!0,this.bodyColumnDefinitions=e.object.columnDefinitions),e.object.rows=e.object.rows.filter((e=>r(this.group,this.kind,e.object.metadata.name))));const o=t?(0,a.Oq)(e.object,this.args,this.drilldownCommand,this.kind,(0,h.QI)(this.args)):(0,l.hb)(e.object,this.kind,this.args,this.drilldownCommand,this.needsStatusColumn,(0,s.Z)(this.kind,this.args));n&&(this.alreadySentHeaders=!0,this.pusher.header(o.header)),o.body.forEach(((t,n)=>{this.readyDebouncer&&void 0===this.readyDebouncer[t.rowKey]?y("dropping untracked row",t.rowKey):("ADDED"===e.type||"MODIFIED"===e.type?this.pusher.update(t,!0):this.pusher.offline(t.rowKey),"Namespace"===this.kind&&("ADDED"===e.type||"DELETED"===e.type)&&(0,m.xf)("CreateOrDeleteNamespace",t.name),this.checkIfReady(t,n,e))})),this.pusher.batchUpdateDone()}checkIfReady(e,t,n){if(this.finalState&&this.nNotReady>0){const o="DELETED"===n.type&&this.finalState===u.d.OfflineLike||("ADDED"===n.type||"MODIFIED"===n.type)&&(0,f.o)(e,this.finalState);y("checking if resource is ready",o,this.finalState,this.nNotReady,e,n.type,n.object.rows[t]),this.readyDebouncer&&o&&!this.readyDebouncer[e.rowKey]&&(y("A resource is in its final state",e.name,this.nNotReady),this.readyDebouncer[e.rowKey]=!0,--this.nNotReady<=0&&(y("All resources are in their final state"),this.abort(),this.pusher.done()))}}}function b(e,t,n,o,i,r,s,a,c,u=!0,l=!1){return v(this,void 0,void 0,(function*(){return i.resourceVersion?Object.assign(i,{watch:new g(e,t,n,i.resourceVersion,r,o,s,a,c,u,l)}):(console.error("Cannot start watching, due to missing resourceVersion"),i)}))}},81634:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var o=n(61032);const{commandPrefix:i}=o.krew,r=i},58253:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o="github.com/kui-shell/plugin-kubectl/v1alpha1"},70690:(e,t,n)=>{"use strict";n.d(t,{VP:()=>b,ZP:()=>k});var o=n(51173),i=n(40227),r=n(21045),s=n(81634),a=n(8749),c=n(79895),u=n(26472),l=n(28040),d=n(53156),p=n(21274),f=n(68491),m=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const h=(0,o.i18n)("plugin-kubectl"),v=e=>(t,n)=>m(void 0,void 0,void 0,(function*(){if((0,p.Ib)(n)){if((0,f.rJ)(n)){const o=yield(0,u.Ao)(t,n);if("view-last-applied"===e)return Object.assign(o,{defaultMode:f.xJ});{const{content:e,contentType:i}=yield(0,f.kL)(t.tab,n),r=(0,l.bt)((0,c.fY)(t),n.metadata.namespace,t,n,"set-last-applied"),s={mode:f.xJ,label:f.PS,order:f.vm-1,content:e,contentType:i,spec:r};return Object.assign(o,{modes:[s],defaultMode:f.xJ,toolbarText:(0,l.gB)(t,n)})}}{const e=new Error(h("This resource has no last applied configuration"));throw e.code=404,e}}}));function y(e,t){const n=(0,c.fY)(t);if((0,a.lN)(t))return(0,a.t$)("k"===n?"kubectl":n,t);const o=t.argvNoOptions.indexOf(e),i=t.argvNoOptions[o+1]||"",r=t.argvNoOptions[o+2]||"",s=t.parsedOptions.f||t.parsedOptions.filename;return s?t.REPL.qexec(`${n} get -f ${s} ${(0,d.UU)(t)} -o yaml`):t.REPL.qexec(`${n} get ${i} ${r} ${(0,d.UU)(t)} -o yaml`)}function g(e){return Object.assign({},i.i,{viewTransformer:e})}function b(e,t){e.listen(`/${s.Z}/${t}/apply/view-last-applied`,y.bind(void 0,"view-last-applied"),g(v("view-last-applied"))),e.listen(`/${s.Z}/${t}/apply/edit-last-applied`,y.bind(void 0,"edit-last-applied"),g(v("edit-last-applied"))),e.listen(`/${s.Z}/${t}/apply/set-last-applied`,r.fF)}function k(e){b(e,"kubectl"),b(e,"k")}},35501:(e,t,n)=>{"use strict";n.d(t,{xf:()=>d,rI:()=>p,$z:()=>f,z2:()=>h,ZP:()=>v});var o=n(51173),i=n(40227),r=n(21045),s=n(81634),a=n(53156),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const u="/kubectl/config/change",l=["delete-cluster","delete-context","rename-context","set","set-cluster","set-context","set-credentials","unset","use-context"];function d(e,t){try{o.eventChannelUnsafe.emit(u,e,t)}catch(e){console.error("Error in onKubectlConfigChangeEvent handler",e)}}function p(e){o.eventChannelUnsafe.on(u,e)}function f(e){o.eventChannelUnsafe.off(u,e)}function m(e){return c(this,void 0,void 0,(function*(){const t=yield(0,r.fF)(e),n=e.argvNoOptions.indexOf("config"),o=e.argvNoOptions[n+1];return("set"===o||"use-context"===o||"set-context"===o&&!e.parsedOptions.current?"NewContext":"set-context"===o||"set-cluster"===o||"set-credentials"===o||"rename-context"===o?"AlteredContext":void 0)&&d("SetNamespaceOrContext",(0,a.wQ)(e)),t}))}function h(e,t){l.forEach((n=>{e.listen(`/${s.Z}/${t}/config/${n}`,m,i.Z)}))}const v=e=>{h(e,"kubectl"),h(e,"k")}},63744:(e,t,n)=>{"use strict";n.d(t,{AF:()=>f,Yi:()=>h,ZP:()=>y});var o=n(40227),i=n(58253),r=n(21045),s=n(81634),a=n(8749),c=n(35501),u=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const l=e=>({command:e,strict:e,docs:"Print your current kubernetes context",example:"kubectl context"}),d=e=>({command:e,strict:e,docs:"List your available kubernetes contexts",optional:[{name:"-o",docs:"Output format",allowed:["wide"]}],example:"kubectl contexts"});function p(e,t){const n=t.attributes.find((t=>t.key===e));return n?n.value:""}function f({REPL:e}){return u(this,void 0,void 0,(function*(){const[t,{content:n}]=yield Promise.all([e.qexec("context"),e.rexec("contexts")]);return n.find((e=>e.metadata.name===t))}))}let m;function h({REPL:e}){return u(this,void 0,void 0,(function*(){if(m)return m;const t='kubectl config view --minify --output "jsonpath={..namespace}"',n=yield e.qexec(t).then((e=>{const n="number"==typeof e?e.toString():e;return"string"!=typeof n||0===n.length?(console.error("Suspicious return value for current namespace",n,t),"default"):n})).then((e=>(m=e,e))).catch((e=>(404===e.code||/command not found/.test(e.message)||console.error("error determining default namespace",e),"default")));return n?n.trim():n}))}(0,c.rI)(((e,t)=>{"SetNamespaceOrContext"===e&&(m="string"==typeof t&&t.length>0?t:void 0)}));const v=e=>u(void 0,void 0,void 0,(function*(){const t=Object.assign({},e.execOptions,{render:!1}),n=yield e.REPL.qexec("kubectl config get-contexts",void 0,void 0,t);return e.execOptions.raw?{mode:"raw",content:n.body.map((t=>({apiVersion:i.Z,kind:"Context",originatingCommand:e,isKubeResource:!0,metadata:{name:p("NAME",t),namespace:p("NAMESPACE",t)},spec:{user:p("AUTHINFO",t),cluster:p("CLUSTER",t),isCurrent:"selected-row"===t.rowCSS||Array.isArray(t.rowCSS)&&t.rowCSS.indexOf("selected-row")>=0}})))}:n})),y=e=>{e.listen(`/${s.Z}/kubectl/config/get-contexts`,(e=>(0,a.lN)(e)?(0,a.t$)("kubectl",e):(0,r.A)(e,void 0,void 0,{entityType:"Context"})),o.Z),e.listen(`/${s.Z}/context`,(({REPL:e})=>u(void 0,void 0,void 0,(function*(){return(yield e.qexec("kubectl config current-context")).trim()}))),Object.assign({usage:l("context")},o.Z)),e.listen(`/${s.Z}/contexts`,v,Object.assign({usage:d("contexts")},o.Z))}},28882:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>R,Dq:()=>E});var o=n(11227),i=n.n(o),r=n(40227),s=n(53156),a=n(21045),c=n(81634),u=n(51173),l=n(65402),d=n(65187),p=n(38957),f=n(96322),m=n(71217),h=n(6394),v=n(60965),y=n(79895),g=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const b=i()("plugin-kubectl/controller/client/direct/create");function k(e,t,n){return g(this,void 0,void 0,(function*(){if(!((0,s.$L)(e)||(0,s.id)(e)||e.parsedOptions["dry-run"]||e.parsedOptions["field-selector"])){const o=yield n||(0,d.St)((0,y.fY)(e),e,e.argvNoOptions[e.argvNoOptions.indexOf(t)+1]),{kind:i,version:r}=o,a=yield(0,m.a)(e,o),c=e.argvNoOptions.indexOf("create")+1,g=e.argvNoOptions.slice(c+1);if("create"===t&&"Namespace"===i&&"v1"===r&&g.length>0&&!e.parsedOptions.context&&!e.parsedOptions.kubeconfig){const t=g.map((e=>({apiVersion:"v1",kind:"Namespace",metadata:{creationTimestamp:null,name:e},spec:{},status:{}}))),n=g.map(a.bind(void 0,!0,!1,void 0)).map((e=>`${e}?fieldManager=kubectl-create`)).join(",");b("attempting create namespace direct",g,n);const r=yield(0,l.dc)(e.REPL,n,{method:"post",headers:h.o,returnErrors:!0,data:t}),{errors:c,okIndices:d,ok:m}=yield(0,f.Z)(r,a,i,e.REPL,!0);if(0===m.length){if(c.length>0&&c.every(u.is404or409))return c.map((e=>e.message)).join("\n")}else{const t=[{names:d.map((e=>g[e])),namespace:yield(0,s.D_)(e),explainedKind:o}],n=yield(0,p.Z)(e,t,v.d.OnlineLike);if(n)return function(e,t){return 0===t.length?e:(0,u.isTable)(e)?[e,...t.map((e=>e.message))]:[...e,...t.map((e=>e.message))]}(n,c)}}}}))}var w=n(8749),x=n(26472),O=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const S=i()("plugin-kubectl/controller/kubectl/create"),$=["create","apply"],E=(e,t="kubectl")=>n=>O(void 0,void 0,void 0,(function*(){if((0,w.lN)(n))return(0,w.t$)(t,n);if((0,s.Dz)(n)){const e=yield(0,a.GL)(n,void 0,t);if((0,s.EC)((0,s.QI)(n))){return yield(0,x._$)(n,e)}return e.content.stdout}try{const t=yield k(n,e);if(t)return t;S("createDirect falling through to CLI impl")}catch(e){if(404===e.code)throw e;console.error("Error in direct create. Falling back to CLI create.",e.code,e)}return(0,a.rJ)(e,v.d.OnlineLike,t)(n)})),C=Object.assign({},r.Z,{viewTransformer:x.c9}),R=e=>{$.forEach((t=>{const n=E(t);e.listen(`/${c.Z}/kubectl/${t}`,n,C),e.listen(`/${c.Z}/k/${t}`,n,C)}))}},80625:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S,q:()=>O});var o=n(40227),i=n(21045),r=n(81634),s=n(11227),a=n.n(s),c=n(51173),u=n(65402),l=n(65187),d=n(53156),p=n(38957),f=n(96322),m=n(71217),h=n(60965),v=n(79895),y=n(6394),g=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const b=a()("plugin-kubectl/controller/client/direct/delete");var k=n(8749),w=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};function x(e){return Object.prototype.hasOwnProperty.call(e.parsedOptions,"wait")?e.command:e.command+" --wait=false"}const O=(e="kubectl")=>t=>w(void 0,void 0,void 0,(function*(){if((0,k.lN)(t))return(0,k.t$)(e,t,x);try{const e=yield function(e,t){return g(this,void 0,void 0,(function*(){if(!((0,d.$L)(e)||(0,d.id)(e)||e.parsedOptions["dry-run"]||e.parsedOptions["field-selector"]||e.parsedOptions.context||e.parsedOptions.kubeconfig)){const n=yield t||(0,l.St)((0,v.fY)(e),e,e.argvNoOptions[e.argvNoOptions.indexOf("delete")+1]),{kind:o}=n,i=yield(0,m.a)(e,n),r={propagationPolicy:"Background"},s=e.argvNoOptions.indexOf("delete")+1,a=e.argvNoOptions.slice(s+1);if(a.length>0){const t=a.map(i.bind(void 0,!0,!1)).join(",");b("attempting delete direct",t);const s=yield(0,u.dc)(e.REPL,t,{method:"delete",headers:y.o,returnErrors:!0,data:r}),{errors:l,ok:m}=yield(0,f.Z)(s,i,o,e.REPL);if(0!==m.length){const t=[{names:a,namespace:yield(0,d.D_)(e),explainedKind:n}];return(0,p.Z)(e,t,h.d.OfflineLike)}if(l.length>0&&l.every(c.is404))return l.map((e=>e.message)).join("\n")}}}))}(t);if(e)return e}catch(e){if(404===e.code)throw e;console.error("Error in direct delete. Falling back to CLI delete.",e.code,e)}return(0,i.rJ)("delete",h.d.OfflineLike,e,x)(t)})),S=e=>{e.listen(`/${r.Z}/kubectl/delete`,O(),o.Z),e.listen(`/${r.Z}/k/delete`,O(),o.Z)}},14945:(e,t,n)=>{"use strict";n.d(t,{L:()=>d,Z:()=>p});var o=n(21045),i=n(81634),r=n(26472),s=n(8749),a=n(79895),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};function u(e){return`${e.command.replace(/(k|kubectl|oc)(\s+)describe(\s+)/,"$1$2get$3")} -o yaml`}const l=e=>function(t){return c(this,void 0,void 0,(function*(){if((0,s.lN)(t))return(0,s.t$)(e,t);if((0,a.HZ)(t))return(0,o.GL)(t,void 0,e);{const n=yield(0,o.GL)(t,u,e);return(0,r._$)(t,n)}}))};function d(e,t,n=t){e.listen(`/${i.Z}/${t}/describe`,l(n),r.L6)}const p=e=>{d(e,"kubectl"),d(e,"k","kubectl")}},28040:(e,t,n)=>{"use strict";n.d(t,{jK:()=>h,bt:()=>y,gB:()=>k,z2:()=>x,ZP:()=>O});var o=n(51173),i=n(40227),r=n(21045),s=n(81634),a=n(26472),c=n(8749),u=n(53156),l=n(21274),d=n(41653),p=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const f=(0,o.i18n)("plugin-kubectl"),m=(0,o.i18n)("plugin-client-common","editor");function h(e){const t=e.modes.find((e=>(0,o.isStringWithOptionalContentType)(e)&&e.spec));return t&&(0,o.isStringWithOptionalContentType)(t)&&"object"==typeof t.spec&&"boolean"==typeof t.spec.readOnly&&"boolean"==typeof t.spec.clearable&&"object"==typeof t.spec.save&&"object"==typeof t.spec.revert}function v(e,t,n){console.error("error in apply for edit",n);const o=n.message.match(/ValidationError\(.*\): ([^]+) in/);if(o&&2===o.length){const e=n.message.match(/unknown field "(.*)"/),i=new Error(o[1]);if(e){const n=new RegExp(`${e[1]}:`),o=t.split(/\n/).findIndex((e=>n.test(e)));o>=0&&(i.revealLine=o+1)}throw i}{const t=n.message.match(/error parsing.*(line .*)/);if(t&&2===t.length){const e=n.message.match(/line (\d+):/),o=new Error(t[1]);throw e&&(o.revealLine=parseInt(e[1])-1),o}{if(-1!==n.message.indexOf("Error from server (Conflict)")){const t=`for: "${e}":`,o=n.message.indexOf(t),i=n.message.substring(o).replace(t,"");throw new Error(i)}const t=n.message.replace(e,"").split("\n");throw":"===t[0].charAt(t[0].length-2)?new Error(t.slice(0,2).join("\n")):new Error(t[0])}}}function y(e,t,n,o,i=""){return{readOnly:!1,clearable:!1,save:{label:f("Apply Changes"),onSave:o=>p(this,void 0,void 0,(function*(){const s=(yield n.REPL.rexec("fwriteTemp",{data:o})).content,a=["k"===e?"kubectl":e,"apply",i,"-n",t,"-f",s].filter((e=>e)),c=Object.assign({},n,{command:a.join(" "),argv:a,argvNoOptions:[e,"apply",i].filter((e=>e)),parsedOptions:{n:t,f:s}});return yield(0,r.d1)(c,void 0,e).catch(v.bind(void 0,s,o)),{command:n.command,noToolbarUpdate:!0}}))},revert:{onRevert:()=>o.kuiRawData}}}function g(e,t,n="edit",o=m("Edit"),i,r){return{mode:n,label:o,order:i,priority:r,spec:e,contentType:"yaml",content:t.kuiRawData}}function b(e,t){return p(this,void 0,void 0,(function*(){if((0,c.lN)(t))return(0,c.t$)(e,t);const n=t.argvNoOptions.indexOf("edit"),o=t.argvNoOptions[n+1]||"",i=t.argvNoOptions[n+2]||"",r=yield(0,u.D_)(t),s=`${e} get ${o} ${i} -n ${r} -o yaml`,a=yield t.REPL.qexec(s),d=(0,l.oe)(a)?a.items[0].kind:a.kind,p=(0,l.oe)(a)?a.items[0].metadata:a.metadata,m=(0,l.oe)(a)&&1!==a.items.length?f("nItems",a.items.length):p.name,h=p.namespace,v=y(e,h,t,a);if((0,l.oe)(a)){return{apiVersion:"kui-shell/v1",kind:d,metadata:{name:m,namespace:h},spec:v,modes:[g(v,a)]}}return a}))}function k(e,t){const n={type:"info",text:m("isUpToDate")};return function(e){const t=e;return t&&t.data&&void 0!==t.data.partOfApply}(e.execOptions)?Object.assign(n,{alerts:[{type:"success",title:f("Successfully Applied")}]}):t.toolbarText}function w(e,t,n){return p(this,void 0,void 0,(function*(){if(!(0,l.oe)(n)&&(0,l.Ib)(n))return o=d.xJ,i=yield function(e,t,n){return p(this,void 0,void 0,(function*(){const o=y(e,n.metadata.namespace,t,n),i=yield(0,a.Ao)(t,n);return Object.assign({},i,{modes:[g(o,n,d.xJ,d.PS,d.vm,100)],toolbarText:k(t,n)})}))}(e,t,n),Object.assign(i,{defaultMode:o});var o,i}))}function x(e,t){e.listen(`/${s.Z}/${t}/edit`,b.bind(void 0,t),(e=>Object.assign({},i.Z,{viewTransformer:w.bind(void 0,e)}))(t))}function O(e){x(e,"kubectl"),x(e,"k")}},21045:(e,t,n)=>{"use strict";n.d(t,{W5:()=>c,ir:()=>l,d1:()=>d,fF:()=>p,GL:()=>m,A:()=>h,rJ:()=>v,I$:()=>y});var o=n(51173),i=n(31343),r=n(67808),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const a=(0,o.i18n)("plugin-kubectl"),c=e=>e.command;function u(e,t){return t.argvNoOptions.slice(t.argvNoOptions.indexOf(e)+1)}function l(e,t=c,n="kubectl"){return s(this,void 0,void 0,(function*(){const o=`_${n}$1`,i=t(e).replace(new RegExp(`^${n}(\\s)?`),o).replace(/^k(\s)?/,o),r=new RegExp(`_${n}(\\s)?`).test(i)?i:`_${n} ${i}`;return e.REPL.qexec(r,void 0,void 0,e.execOptions).catch((e=>{throw 500!==e.code&&500!==e.statusCode||(e.code=e.statusCode=500),e}))}))}function d(e,t=c,n){return l(e,t,n).then((e=>e.content.stdout))}function p(e,t=c){return s(this,void 0,void 0,(function*(){if((0,o.isHeadless)()||!(0,o.inBrowser)()&&e.execOptions.raw)return d(e,t);{const t=e.command.replace(/^k(\s)/,"kubectl$1");return e.execOptions.onInit&&(e.execOptions.quiet=!0,e.execOptions.replSilence=!0,e.execOptions.echo=!1),e.REPL.qexec(`sendtopty ${t}`,e.block,void 0,e.execOptions.onInit?e.execOptions:Object.assign({},e.execOptions,{rawResponse:!0,quiet:void 0===e.execOptions.quiet?e.execOptions.type!==o.ExecType.TopLevel&&void 0:e.execOptions.quiet})).catch((e=>{throw 500!==e.code&&500!==e.statusCode||(e.code=e.statusCode=500),e}))}}))}function f(e,t=c){return s(this,void 0,void 0,(function*(){return new Promise(((n,o)=>s(this,void 0,void 0,(function*(){let i="";const r=Object.assign({},e.execOptions,{rethrowErrors:!0,quiet:!0,replSilence:!0,echo:!1,onInit:()=>e=>{"string"==typeof e&&(i+=e)}}),s=Object.assign({},e,{execOptions:r});yield p(s,t).catch((e=>{console.error(e),o(e)})),n(i)}))))}))}function m(e,t=c,n="kubectl"){return s(this,void 0,void 0,(function*(){return e.argvNoOptions.includes("|")?Promise.resolve({content:{code:0,stdout:yield p(e,t),stderr:void 0,wasSentToPty:!0}}):l(e,t,n)}))}function h(e,t=c,n="kubectl",{usePty:o=!1,nameColumn:i,verb:u,entityType:d}={}){return s(this,void 0,void 0,(function*(){const s=o?{content:{stdout:yield f(e,t),stderr:void 0}}:yield l(e,t,n),c=yield(0,r.rW)(s.content.stdout,s.content.stderr,e,n,u,d,i);if("string"==typeof c)throw new Error(a("Unable to parse table"));return c}))}const v=(e,t,n="kubectl",r=c,a=u)=>c=>s(void 0,void 0,void 0,(function*(){const s=yield m(c,r,n);if(0!==s.content.code){const e=new Error(s.content.stderr);throw e.code=s.content.code,e}if((0,o.isHeadless)())return s.content.stdout;{const o=yield a(e,c),r=s?`--response "${s.content.stdout}"`:"";return(0,i.$)(c,e,n,r,t,o)}}));function y(e,t,n,{title:o=(0===e.length?void 0:e[0].kind),nameColumnTitle:i="NAME"}={}){return s(this,void 0,void 0,(function*(){if(e.length>0)return{apiVersion:"kui-shell/v1",kind:"RadioTable",title:o,defaultSelectedIdx:t,header:{cells:[i]},body:e.map((e=>{const t=e.metadata.name;return{nameIdx:0,cells:[t],onSelect:n(t,e)}}))}}))}},65187:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>L,ZK:()=>A,St:()=>j});var o=n(11227),i=n.n(o),r=n(51173),s=n(40227),a=n(21858),c=n(21045),u=n(81634),l=n(8749),d=n(53156);const p={kind:"Pod",version:"v1",isClusterScoped:!1},f={kind:"Secret",version:"v1",isClusterScoped:!1},m={kind:"Namespace",version:"v1",isClusterScoped:!0},h={kind:"Node",version:"v1",isClusterScoped:!0},v={kind:"PersistentVolume",version:"v1",isClusterScoped:!0},y={kind:"ControllerRevision",version:"apps/v1",isClusterScoped:!1},g={kind:"DaemonSet",version:"apps/v1",isClusterScoped:!1},b={kind:"ReplicaSet",version:"apps/v1",isClusterScoped:!1},k={kind:"StatefulSet",version:"apps/v1",isClusterScoped:!1},w={kind:"Deployment",version:"apps/v1",isClusterScoped:!1},x={kind:"Service",version:"v1",isClusterScoped:!1},O={kind:"Event",version:"v1",isClusterScoped:!1},S={po:p,pod:p,pods:p,Pod:p,Pods:p,secret:f,secrets:f,Secret:f,Secrets:f,ns:m,namespace:m,namespaces:m,Namespace:m,Namespaces:m,svc:x,service:x,services:x,Service:x,Services:x,controllerrevision:y,controllerrevisions:y,ControllerRevision:y,"ControllerRevision.v1.apps":y,ControllerRevisions:y,ds:g,daemonset:g,daemonsets:g,DaemonSet:g,"DaemonSet.v1.apps":g,DaemonSets:g,rs:b,replicaset:b,replicasets:b,ReplicaSet:b,"ReplicaSet.v1.apps":b,ReplicaSets:b,sts:k,statefulset:k,statefulsets:k,StatefulSet:k,"StatefulSet.v1.apps":k,StatefulSets:k,deploy:w,deployment:w,deployments:w,Deployment:w,"Deployment.v1.apps":w,Deployments:w,no:h,node:h,nodes:h,Node:h,Nodes:h,ev:O,event:O,events:O,Event:O,Events:O,pv:v,persistentvolume:v,persistentvolumes:v,Persistentvolume:v,Persistentvolumes:v};var $=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const E=(0,r.i18n)("plugin-kubectl"),C=i()("plugin-kubectl/controller/kubectl/explain");function R(e,t){return{mode:t[1],contentType:"text/markdown",content:`### Type\n${t[2]}\n### Documentation\n${n=t[4],n.replace(/\n/g," ").replace(/(More info:\s+)?(https:\/\/.*)/,((e,t,n)=>`\n\n[Consult official Kubernetes documentation](${function(e){return/api-conventions/.test(e)&&!/sig-architecture/.test(e)?e.replace(/api-conventions/,"sig-architecture/api-conventions"):e}(n)})`))}\n\n[Explain this field](#kuiexec?command=${encodeURIComponent(e+"."+t[1])})\n`};var n}const N=/^KIND:\s+(\S+)\nVERSION:\s+(\S+)(\n\nRESOURCE:\s+(\S+).*)?\n\nDESCRIPTION:\n(\s*DEPRECATED - )?([\s\S]+)/,P=/^KIND:\s+(\S+)\nVERSION:\s+(\S+)(\n\nRESOURCE:\s+(\S+).*)?\n\nDESCRIPTION:\n(\s*DEPRECATED - )?([\s\S]+)\n\nFIELDS:\n([\s\S]+)/,D=/^KIND:\s+(\S+)\nVERSION:\s+(\S+)\n\nFIELD:\s+(\S+)\s+(.*)\n\nDESCRIPTION:\n(\s*DEPRECATED - )?([\s\S]+)/,T=(e="kubectl")=>function(t){return $(this,void 0,void 0,(function*(){if((0,l.lN)(t))return(0,l.t$)(e,t);const n=yield(0,c.d1)(t,void 0,e);try{const e=n.match(P)||n.match(N),o=!e&&n.match(D);if(e||o){const n=e?e[1]:o[1],i=e?e[2]:o[2],r=e&&e[4],s=o&&o[3],a=o&&o[4],c=e?e[5]:o[5],u=e?e[6]:o[6],l=e&&e[7],d=l?l.split(/\n\n/).filter((e=>e)).map((e=>e.match(/\s*(\S+)\s+<(\S+)>( -required-)?\n\s*([\s\S]*)/))).filter((e=>e)):[],p=d.filter((e=>e[3])),f=d.filter((e=>!e[3])),m={label:"API Resources",command:"kubectl api-resources"},h=i?i.match(/^([^/]+)\//):void 0,v=h?[{label:h[1],command:`kubectl api-resources --api-group ${h[1]}`}]:[],y=r?[{label:r}]:[],g=o?[{label:s}]:[],b=R.bind(void 0,t.command);return{apiVersion:"kui-shell/v1",kind:"NavResponse",breadcrumbs:[m].concat(v).concat([{label:n,command:r||s?`kubectl explain ${n}`:""}]).concat(y).concat(g),menus:[{label:r||n,items:[{mode:"Overview",contentType:"text/markdown",content:`### Description\n#### ${u.replace(/\n/g," ")}\n${o?`### Type\n${a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\[/g,"&#91;").replace(/\]/g,"&#93;")}`:""}\n### Version\n${i}\n${c?`### Warnings\n${E("This API Resource is deprecated")}`:""}\n    `}]}].concat(0===p.length?[]:[{label:"Required Fields",items:p.map(b)}]).concat(0===f.length?[]:[{label:"Fields",items:f.map(b)}])}}}catch(e){console.error("error parsing explaing",e)}return n}))},I={},Z={cs:!0,"ComponentStatus.v1":!0,componentstatus:!0,componentstatuses:!0,ns:!0,namespace:!0,"Namespace.v1":!0,namespaces:!0,no:!0,"Node.v1":!0,node:!0,nodes:!0,pv:!0,"PersistentVolume.v1":!0,persistentvolume:!0,persistentvolumes:!0,crd:!0,crds:!0,"CustomResourceDefinition.apiextensions.k8s.io/v1":!0,"customresourcedefinitions.apiextensions.k8s.io":!0,csr:!0,"CertificateSigningRequest.certificates.k8s.io/v1":!0,"certificatesigningrequests.certificates.k8s.io":!0,psp:!0,"PodSecurityPolicy.policy/v1":!0,"podsecuritypolicies.policy":!0,pc:!0,"PriorityClass.scheduling.k8s.io/v1":!0,"priorityclasses.scheduling.k8s.io":!0,sc:!0,"StorageClass.storage.k8s.io/v1":!0,"storageclasses.storage.k8s.io":!0,"MutatingWebhookConfiguration.admissionregistration.k8s.io/v1":!0,"mutatingwebhookconfigurations.admissionregistration.k8s.io":!0,"ValidatingWebhookConfiguration.admissionregistration.k8s.io/v1":!0,"validatingwebhookconfigurations.admissionregistration.k8s.io":!0,"APIService.apiregistration.k8s.io/v1":!0,"apiservices.apiregistration.k8s.io":!0,"TokenReview.authentication.k8s.io/v1":!0,"tokenreviews.authentication.k8s.io":!0,"SelfSubjectAccessReview.authorization.k8s.io/v1":!0,"selfsubjectaccessreviews.authorization.k8s.io":!0,"SelfSubjectRulesReview.authorization.k8s.io/v1":!0,"selfsubjectrulesreviews.authorization.k8s.io":!0,"SubjectAccessReview.authorization.k8s.io/v1":!0,"subjectaccessreviews.authorization.k8s.io":!0,"Node.metrics.k8s.io/v1":!0,"nodes.metrics.k8s.io":!0,"ClusterRoleBinding.rbac.authorization.k8s.io/v1":!0,"clusterrolebindings.rbac.authorization.k8s.io":!0,"ClusterRole.rbac.authorization.k8s.io/v1":!0,"clusterroles.rbac.authorization.k8s.io":!0,"ClusterRbacConfig.rbac.istio.io/v1":!0,"clusterrbacconfigs.rbac.istio.io":!0,"CSIDriver.storage.k8s.io/v1":!0,"csidrivers.storage.k8s.io":!0,"CSINode.storage.k8s.io/v1":!0,"csinodes.storage.k8s.io":!0,"VolumeAttachment.storage.k8s.io/v1":!0,"volumeattachments.storage.k8s.io":!0};function j(e,t,n){if(n){const o=S[n];return o?Promise.resolve(o):(I[n]||(I[n]=function(e,t,n){return $(this,void 0,void 0,(function*(){try{const o=Object.assign({},t,{command:(0,d.QG)(t,`${e} explain ${(0,a.Vl)(n).kind}`)}),i=(yield(0,c.d1)(o,void 0,e).catch((e=>(C(e),`KIND: ${n}\nVERSION: v1`)))).match(/^KIND:\s+(.*)\nVERSION:\s+(.*)/);if(i){const e=i[1],t=i[2];return{kind:e,version:t,isClusterScoped:Z[`${e}.${t}`]||!1}}return{kind:n,version:"v1",isClusterScoped:Z[n]||!1}}catch(e){if(!/does not exist/i.test(e.message))throw console.error(`error explaining kind ${n}`,t,e),e}}))}(e,t,n)),I[n])}}function A(e,t,n){return $(this,void 0,void 0,(function*(){return(yield j(e,t,n)).kind}))}const L=e=>{const t=T();e.listen(`/${u.Z}/kubectl/explain`,t,s.Z),e.listen(`/${u.Z}/k/explain`,t,s.Z)}},40227:(e,t,n)=>{"use strict";n.d(t,{i:()=>i,Z:()=>r});const o=["w","watch","watch-only","A","all-namespaces","ignore-not-found","no-headers","i","it","ti","stdin","t","tty","R","recursive","server-print","show-kind","show-labels"];function i(e=[]){return{flags:{configuration:{"short-option-groups":!1,"duplicate-arguments-array":!1},narg:{w:0,watch:0,"watch-only":0},string:["_"],boolean:e.concat(o)}}}const r=i()},21858:(e,t,n)=>{"use strict";function o(e){const[t,n]=e.split("/");return n?{group:t,version:n}:{group:"",version:""}}function i(e){const[t,n,o]=e.split(/\./);return{kind:t,group:n,version:o}}function r(e,t){return`${t}${function(e){const{group:t,version:n}=o(e);return t.length>0?`.${n}.${t}`:""}(e)}`}function s(e){return r(e.apiVersion,e.kind)}function a(e){return`${s(e)} -n ${e.metadata.namespace}`}function c(e,t,n,o){return"Namespace"===t&&"v1"===e?`${t} ${n}`:`${r(e,t)} ${"<none>"===o?"":`-n ${o}`} ${n}`}function u(e){return c(e.apiVersion,e.kind,e.metadata.name,e.metadata.namespace)}function l({group:e,version:t,kind:n,name:o,namespace:i}){return`${n}${e?`.${t}.${e}`:""} ${"<none>"===i?"":`-n ${i}`} ${o}`}n.d(t,{cR:()=>o,Vl:()=>i,M5:()=>r,H1:()=>s,v6:()=>a,kJ:()=>c,uE:()=>u,UD:()=>l})},26472:(e,t,n)=>{"use strict";n.d(t,{Bm:()=>k,_$:()=>w,Ao:()=>S,gc:()=>$,c9:()=>E,L6:()=>C,Yn:()=>R,ZP:()=>N});var o=n(51173),i=n(40227),r=n(21045),s=n(81634),a=n(96218),c=n(31276),u=n(21858),l=n(65187),d=n(79895),p=n(8749),f=n(53156),m=n(67808),h=n(21274),v=n(44593),y=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const g=(0,o.i18n)("plugin-kubectl");function b(e){const t=e.command.indexOf(" get ")+" get ".length,n=e.command.slice(0,t-1),o=e.command.slice(t-1);return n+["-w=true","--watch=true","--watch-only=true","-w","--watch","--watch-only"].reduce(((e,t)=>e.replace(new RegExp(`(\\s)${t}`),"$1")),o)}function k(e,t,n,o="get",i){return y(this,void 0,void 0,(function*(){const{content:{stderr:r,stdout:s}}=n,a=i||t.argvNoOptions[t.argvNoOptions.indexOf(o)+1],c=yield(0,m.rW)(s,r,t,e,o,a);return(0,m.jU)(c)}))}function w(e,t){return y(this,void 0,void 0,(function*(){try{const o=t.content.stdout,{safeLoad:i,safeDump:r}=yield n.e(3320).then(n.t.bind(n,93320,23)),s="json"===(0,f.QI)(e)?JSON.parse(o):yield i(o),a=Object.assign(s,{isKubeResource:!0,originatingCommand:e,kuiRawData:o});if((0,h.oe)(a)){if(!(a.items.length>0))return t;yield Promise.all(a.items.map((t=>y(this,void 0,void 0,(function*(){return Object.assign(t,{isKubeResource:!0,originatingCommand:e,kuiRawData:yield r(t)})})))))}return a}catch(e){throw console.error("error handling entity response; raw=",t.content.stdout),e}}))}function x(e){return new Date(e.metadata.creationTimestamp).toLocaleString()}function O(e){const t="info",n=void 0!==e.metadata.creationTimestamp,o=(0,h.pL)(e);return n&&o?{type:t,text:g("createdOn=X resourceVersion=Y",x(e),e.metadata.resourceVersion)}:n?{type:t,text:g("createdOn",x(e))}:o?{type:t,text:g("resourceVersion=Y",x(e),e.metadata.resourceVersion)}:void 0}function S(e,t){return y(this,void 0,void 0,(function*(){try{const{name:o,nameHash:i,version:r}=(0,c.Z)(t);if((0,h.oe)(t))return{apiVersion:t.apiVersion,kind:t.kind,metadata:{name:e.command,namespace:yield(0,f.D_)(e)},isSimulacrum:!0,originatingCommand:e,isKubeResource:!0,modes:[],kuiRawData:t.kuiRawData};const s=()=>y(this,void 0,void 0,(function*(){if((0,f.qy)(e)){const{safeLoad:o,safeDump:i}=yield n.e(3320).then(n.t.bind(n,93320,23)),[r,s]=yield Promise.all([o(t.kuiRawData),o(e.execOptions.data.diff)]),[a,c]=yield Promise.all([i(r),i(s)]);return{mode:"diff",label:g("sidecarLabelNewDiff"),content:{a:(0,d.p2)(a),b:(0,d.p2)(c)},contentType:"yaml"}}}));return Object.assign(t,{prettyName:o,nameHash:i,version:r,comparator:h.Yy,isKubeResource:!0,toolbarText:O(t),onclick:{kind:`kubectl get ${(0,u.v6)(t)}`,name:`kubectl get ${(0,u.v6)(t)} ${t.metadata.name}`,namespace:t.metadata.namespace?`kubectl get ns ${t.metadata.namespace} -o yaml`:void 0},defaultMode:f.qy&&"diff",modes:[yield s()].filter((e=>e)),kuiRawData:t.kuiRawData})}catch(e){throw console.error("error handling entity response",t),e}}))}const $=e=>function(t){return y(this,void 0,void 0,(function*(){if((0,p.lN)(t))return(0,p.t$)(e,t,b);const n=(0,f.cV)(t),i=n&&!(0,f.zU)(t)?(0,l.St)(e,t,t.argvNoOptions[t.argvNoOptions.indexOf("get")+1]):void 0;if(!(0,o.isHeadless)()&&(0,f.CC)(t)&&(/jsonpath|go-template/.test((0,f.QI)(t))||t.parsedOptions.context||t.parsedOptions.kubeconfig)&&!/^k(ubectl)?\s+-/.test(t.command)){const e=(0,f.QI)(t);return i&&"Event"===(yield i).kind&&"wide"!==e?((e,t)=>{if(t){const n=e.command.replace(`${e.parsedOptions.o?"-o":"--output"} ${t}`,"-o wide");return e.REPL.qexec(n)}{const t=`${e.command} -o wide`;return e.REPL.qexec(t)}})(t,e):(0,a.Z)(t)}if(t.parsedOptions.limit){t.command=t.command.replace(/--limit \d+/g,"");const e=t.argv.indexOf("--limit");e>=0&&t.argv.splice(e,2),t.execOptions.data||(t.execOptions.data={limit:t.parsedOptions.limit})}const s=yield function(e,t,n=((0,f.zU)(e)?void 0:(0,l.St)(t,e,e.argvNoOptions[e.argvNoOptions.indexOf("get")+1]))){return y(this,void 0,void 0,(function*(){const o="k"===t?"kubectl":t,i="all"===e.argvNoOptions[e.argvNoOptions.indexOf("get")+1]||!(0,f.zU)(e)&&!n;if(!("oc"!==o&&"kubectl"!==o||e.argvNoOptions.includes("|")||i||e.parsedOptions.context||e.parsedOptions.kubeconfig))try{const t=yield(0,v.ZP)(e,n);if(t)return t}catch(e){if(500!==e.code)throw e;console.error("unexpected apiServer error, intentionally fallback to kubectl CLI",e)}return(0,r.GL)(e,b,o).catch((e=>{throw delete e.statusCode,e.message=e.message.trim(),e}))}))}(t,e,i);if((0,m.Lk)(s))return s;if(0===s.content.code||n||0!==s.content.stdout.length)return s.content.wasSentToPty?s.content.stdout:(0,f.IY)(t)?w(t,s):n?k(e,t,s,void 0,(yield i).kind):function(e,t){return t.content.stdout.trim()}(0,s);{const e=new Error(s.content.stderr);throw e.code=s.content.code,e}}))};function E(e,t){return y(this,void 0,void 0,(function*(){if((0,h.Ib)(t))return S(e,t);if("string"==typeof t&&"name"===(0,f.QI)(e)){const{version:n,kind:i}=yield(0,l.St)((0,d.fY)(e),e,e.argvNoOptions[e.argvNoOptions.indexOf("get")+1]);return{style:o.TableStyle.Light,defaultPresentation:"grid",allowedPresentations:["grid"],body:t.split(/\n/).map((t=>({name:t,onclick:(0,f.QG)(e,`kubectl get ${(0,u.M5)(n,i)} ${t} -o yaml`)})))}}}))}const C=Object.assign({},i.Z,{viewTransformer:function(e,t){return!(0,h.Ib)(t)&&(0,f.qy)(e)&&"string"==typeof e.execOptions.data.diff?function(e){const t=e.argvNoOptions[e.argvNoOptions.indexOf("get")+1],n={mode:"diff",label:g("sidecarLabelNewDiff"),content:e.execOptions.data.diff,contentType:"yaml"};return{apiVersion:"kui-shell/v1",kind:t,metadata:{name:(0,f.vI)(t,e),namespace:(0,f.wQ)(e)},toolbarText:{type:"info",text:g("drilldownNewDiff")},modes:[n]}}(e):E(e,t)}});function R(e,t,n=t){e.listen(`/${s.Z}/${t}/get`,$(n),C)}const N=e=>{R(e,"kubectl"),R(e,"k","kubectl")}},53156:(e,t,n)=>{"use strict";n.d(t,{zU:()=>a,Wb:()=>c,tX:()=>u,W2:()=>l,$L:()=>d,QI:()=>p,EC:()=>f,IY:()=>m,LJ:()=>h,kr:()=>v,$:()=>y,cV:()=>g,CC:()=>b,nf:()=>k,id:()=>w,xT:()=>x,kb:()=>O,wQ:()=>S,D_:()=>$,UU:()=>E,vI:()=>C,ZO:()=>R,zr:()=>N,Dk:()=>P,QG:()=>D,wU:()=>T,Dz:()=>I,qy:()=>Z});var o=n(63744),i=n(79895),r=n(48764).Buffer,s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};function a(e){const t=e.parsedOptions.f||e.parsedOptions.filename;return"string"==typeof t?t:void 0}function c(e){return{filepath:a(e),isFor:e.parsedOptions.f?"f":"filename"}}function u(e){return e.parsedOptions.k||e.parsedOptions.kustomize}function l(e,t=!1){const n=a(e);if(n)return`-f ${n}${t?" ":""}`;{const n=u(e);if(n)return`-k ${n}${t?" ":""}`}return""}function d(e){const t=a(e);if(t)return t;{const t=u(e);if(t)return t}}function p({parsedOptions:e}){return e.o||e.output}function f(e){return"yaml"===e||"json"===e}function m(e){return f(p(e))}function h(e){return/^custom-columns=/.test(e)}function v(e){return e.parsedOptions.help||e.parsedOptions.h}function y(e){return v(e)||"help"===e.argvNoOptions[1]||"options"===e.argvNoOptions[1]}function g(e){return!(t=p(e))||"wide"===t||h(t)||/^custom-columns-file=/.test(t);var t}function b(e){return!!(e.parsedOptions.w||e.parsedOptions.watch||e.parsedOptions["watch-only"])}function k(e,t=!1){return t?"--watch":e.parsedOptions.w?"-w":e.parsedOptions.watch?"--watch":e.parsedOptions["watch-only"]?"--watch-only":""}function w({parsedOptions:e}){const t=e.l||e.label;if(t)return t;{let t;for(const n in e)if(/^l.+/.test(n)&&"limit"!==n){const o=e[n];o&&(t=`${n.slice(1)}=${o}`)}return t}}function x(e){const t=w(e);return t?`-l ${t}`:""}function O(e){if(e.parsedOptions.l||e.parsedOptions.label)return!0;for(const t in e.parsedOptions)if(/^l/.test(t))return!0;return!1}function S(e){return e.parsedOptions.n||e.parsedOptions.namespace}function $(e){return s(this,void 0,void 0,(function*(){return e.parsedOptions.n||e.parsedOptions.namespace||(yield(0,o.Yi)(e))}))}function E({parsedOptions:e}){const t=e.n||e.namespace;return t?`-n ${t}`:""}function C(e,t){return t.argvNoOptions.slice(t.argvNoOptions.indexOf(e)+1)}function R(e,t){const n=e.parsedOptions.c||e.parsedOptions.container;if(n)return n;{const n=e.argvNoOptions.indexOf(t);return e.argvNoOptions[n+2]}}function N(e){const t=function(e){return e.parsedOptions.context}(e);return t?`--context ${t}`:""}function P(e){return e.A||e["all-namespaces"]}function D(e,t){let n=" ";e.parsedOptions.kubeconfig&&!/--kubeconfig/.test(t)&&(n+=` --kubeconfig ${e.parsedOptions.kubeconfig}`),e.parsedOptions.context&&!/--context/.test(t)&&(n+=` --context ${e.parsedOptions.context}`),e.parsedOptions.cluster&&!/--cluster/.test(t)&&(n+=` --cluster ${e.parsedOptions.cluster}`),/\s(-n|--namespace)/.test(t)||/(get|apply|create|delete|explain)\s+(ns|namespace|namespaces|Namespace|Namespaces)\b/.test(t)||(n+=` ${E(e)} `);const o=t.indexOf(" -- ");return o<0?t+n:t.slice(0,o)+n+t.slice(o)}function T(e,t){return n=e.execOptions.data,r.isBuffer(n)||"object"!=typeof n||"string"!=typeof n.kubectlPrefix?D(e,`${(0,i.fY)(e)} ${t}`):D(e,`${e.execOptions.data.kubectlPrefix} ${t}`);var n}function I(e){const t=e.parsedOptions["dry-run"];return"boolean"==typeof t||"client"===t||"server"===t}function Z(e){return e.execOptions.data&&e.execOptions.data.diff}},65458:(e,t,n)=>{"use strict";n.d(t,{g8:()=>f,ZP:()=>m});var o=n(11227),i=n.n(o),r=n(32383),s=n(51173),a=n(40227),c=n(81634),u=n(7716),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const d=i()("plugin-kubeui/controller/kubectl/raw");function p(e,t){const n=e.argv.indexOf(1===t.length?`-${t}`:`--${t}`);if(n>=0){const t=e.argv[n+1];t&&(e.argv[n+1]=(0,s.expandHomeDir)(t))}}const f=e=>new Promise(((t,n)=>{const o=Object.assign({},(0,s.inBrowser)()?{}:u.env,e.execOptions.env);delete o.DEBUG,function(e,t){p(e,"cache-dir"),p(e,"certificate-authority"),p(e,"client-key"),p(e,"client-certificate"),p(e,"kubeconfig"),p(e,e.parsedOptions.f?"f":"filename"),p(e,e.parsedOptions.k?"k":"kustomize"),t.HOME&&(t.HOME=(0,s.expandHomeDir)(t.HOME))}(e,o);const i=e.argv[0].replace(/^_/,""),a=(0,r.spawn)(i,e.argv.slice(1),{env:o});a.on("error",(e=>{console.error(`error spawning ${i}`,e),n(e)}));let c="";a.stdout.on("data",(e=>{c+=e.toString()}));let f="";a.stderr.on("data",(e=>{f+=e.toString()})),a.on("close",(o=>l(void 0,void 0,void 0,(function*(){(f.length>0||0!==o)&&(d("exec has stderr with code %s",o),d("exec stderr command",e.command),d("exec stdeout",c),d("exec stderr",f));const i=/no resources found/i.test(f);if(0!==c.length||0===o&&!i)t({content:{code:o,stdout:c,stderr:f,wasSentToPty:!1}});else{const t=f,r=/error: the path/.test(t),s=i||/not found/i.test(t)||/doesn't have/i.test(t)||/couldn't find/.test(t)?404:/already exists/i.test(t)?409:r?412:500;if(e.execOptions.failWithUsage)n(new Error(void 0));else{const e=new Error(t);e.statusCode=o,e.code=s,n(e)}}}))))}));const m=e=>l(void 0,void 0,void 0,(function*(){e.listen(`/${c.Z}/_kubectl`,f,Object.assign({},a.Z,{requiresLocal:!0}))}))},14867:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f,d:()=>p});var o=n(40227),i=n(21045),r=n(81634),s=n(60965),a=n(8749),c=n(79895),u=n(53156);var l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};function d(e,t){return l(this,void 0,void 0,(function*(){const{major:n,minor:o}=yield this;return[1===n&&o<16?"deployment":"pod",t.argvNoOptions[t.argvNoOptions.indexOf(e)+1]]}))}const p=(e="kubectl")=>t=>{if((0,a.lN)(t))return(0,a.t$)(e,t);{const n=function(e){return e.REPL.qexec((0,u.QG)(e,`${(0,c.fY)(e)} version -o json`)).then((e=>"string"==typeof e?JSON.parse(e):e)).then((({serverVersion:e})=>({major:parseInt(e.major,10),minor:parseInt(e.minor,10)})))}(t),o=d.bind(n);return(0,i.rJ)("run",s.d.OnlineLike,e,void 0,o)(t)}},f=e=>{const t=p();e.listen(`/${r.Z}/kubectl/run`,t,o.Z),e.listen(`/${r.Z}/k/run`,t,o.Z)}},31343:(e,t,n)=>{"use strict";n.d(t,{$:()=>O,o:()=>k});var o=n(11227),i=n.n(o),r=n(51173);function s(e,t){return{templates:e.map((({filepath:e,data:n})=>({filepath:e,data:n,isFor:t,kind:"source",contentType:"yaml"})))}}var a=n(65187),c=n(21858),u=n(67808),l=n(38957),d=n(53156),p=n(96218),f=n(21274),m=n(65402),h=n(54476),v=n(60965),y=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const g=(0,r.i18n)("plugin-kubectl"),b=i()("plugin-kubectl/controller/kubectl/status");function k(e,t){const n=e.attributes.find((e=>/STATUS/i.test(e.key)));if(void 0!==n)return(0,v._)(n.value,t);{const t=e.attributes.find((e=>/READY/i.test(e.key)));if(void 0!==t){const[e,n]=t.value.split(/\//);return e&&n&&e===n}}return!0}class w{constructor(e,t,n,o,i,r,s,a,c=1e3,u=w.calculateLadder(c)){this.tab=e,this.ref=t,this.row=n,this.finalState=o,this.done=i,this.pusher=r,this.contextArgs=s,this.command=a,this.ladder=u,this.pollOnce(0)}pollOnce(e){return y(this,void 0,void 0,(function*(){const t=e<this.ladder.length?this.ladder[e]:this.ladder[this.ladder.length-1];b("pollOnce",this.ref,t,(0,c.UD)(this.ref));try{const e=yield this.tab.REPL.qexec(`${this.command} get ${(0,c.UD)(this.ref)} ${this.contextArgs} -o wide`);if(b("pollOnce table",e),e&&e.body&&1===e.body.length){const t=e.body[0],n=k(t,this.finalState),o=t.attributes.find((e=>/STATUS/i.test(e.key)))||t.attributes.find((e=>/READY/i.test(e.key))),i=function(e){const t=Object.assign({},e);return t.attributes=e.attributes.map((e=>Object.assign({},e))),t}(this.row),r=i.attributes.find((({key:e})=>/STATUS/i.test(e)));if(r.value=o?o.value:"Ready",n&&(r.css=this.finalState===v.d.OnlineLike?h.Z.Green:h.Z.Red),this.pusher.update(i),n)return b("resource is ready",this.ref,this.row,o),void this.done()}else console.error("unexpected tabular response in poller",e)}catch(e){if(404===e.code&&this.finalState===v.d.OfflineLike)return this.pusher.offline(this.ref.name),void this.done()}this.timer=setTimeout((()=>this.pollOnce(e+1)),t)}))}static calculateLadder(e){let t=5e3;try{t=Object(function(){var e=new Error("Cannot find module '@kui-shell/client/config.d/limits.json'");throw e.code="MODULE_NOT_FOUND",e}()).tablePollingInterval}catch(e){b("using default tablePollingInterval",e)}const n=[e];let o=e;for(;o<t;)o<1e3?(o=o+250<1e3?o+250:1e3,n.push(o)):(n.push(o),o=o+2e3<t?o+2e3:t,n.push(o));return n}abort(){this.timer&&clearTimeout(this.timer)}}class x{constructor(e,t,n,o,i,r){this.args=e,this.tab=t,this.resourcesToWaitFor=n,this.finalState=o,this.contextArgs=i,this.command=r,this.pollers=[],this.ptyJob=[]}abortEventWatchers(){this.ptyJob&&(this.ptyJob.forEach((e=>e.abort())),this.ptyJob=[])}abort(){this.pollers.forEach((e=>{e&&e.abort()})),this.ptyJob&&(this.ptyJob.forEach((e=>e.abort())),this.ptyJob=[])}init(e){let t=this.resourcesToWaitFor.length;const n=()=>{if(0==--t){b("all resources are ready"),e.done();for(let e=0;e<this.pollers.length;e++)this.pollers[e]=void 0;this.ptyJob&&(this.ptyJob.forEach((e=>e.abort())),this.ptyJob=[])}};this.resourcesToWaitFor.map(((t,o)=>{const{kind:i,name:r,namespace:s}=t,a=new p.l(this.args,this.command,i,[r],s,!0,e);a.init(),this.ptyJob.push(a);const c=this.initialBody[o];return new w(this.tab,t,c,this.finalState,n,e,this.contextArgs,this.command)})).forEach((e=>{this.pollers.push(e)}))}nsAttr(e,t){return t?[{key:"NAMESPACE",value:e}]:[]}initialTable(){const e=(0,d.Dz)(this.args),t=this.resourcesToWaitFor.some((({namespace:e})=>"default"!==e));this.initialBody=this.resourcesToWaitFor.map((n=>{const{group:o="",version:i="",kind:r,name:s,namespace:a}=n;return{name:s,onclick:`${this.command} get ${(0,c.UD)(n)} -o yaml`,onclickIdempotent:!0,attributes:this.nsAttr(a,t).concat([{key:"KIND",value:r+(o.length>0?`.${i}.${o}`:""),outerCSS:"",css:""},{key:"STATUS",tag:"badge",value:g(e?"Dry Run":"Pending"),outerCSS:"",css:h.Z.Yellow}])}}));return{header:{key:"NAME",name:"Name",attributes:this.initialBody[0].attributes.map((({key:e,outerCSS:t})=>({key:e,value:(0,u.s7)(e),outerCSS:t})))},body:this.initialBody,watch:e?void 0:this}}}const O=(e,t,o,i,u,p,h=!0)=>y(void 0,void 0,void 0,(function*(){const g=yield(0,d.D_)(e),k=(0,d.zU)(e),w=(0,d.tX)(e);try{const{resourcesToWaitFor:i,kuiSourceRef:O}=k?yield function(e,t,o){return y(this,void 0,void 0,(function*(){const{isFor:i}=(0,d.Wb)(t),[{safeLoadAll:a},u]=yield Promise.all([n.e(3320).then(n.t.bind(n,93320,23)),(0,m.H4)(t,e,!0)]);return{resourcesToWaitFor:(0,r.flatten)(u.map((e=>a(e.data)))).filter((e=>e.metadata)).map((({apiVersion:e,kind:t,metadata:{name:n,namespace:i=o}})=>{const{group:r,version:s}=(0,c.cR)(e);return{group:r,version:s,kind:t,name:n,namespace:i}})),kuiSourceRef:s(u,i)}}))}(k,e,g):w?yield function(e,t,o){return y(this,void 0,void 0,(function*(){const[i,{safeLoad:r}]=yield Promise.all([(0,m.MJ)(t,e),n.e(3320).then(n.t.bind(n,93320,23))]),s=yield Promise.all(i.templates.map((e=>r(e.data))).map((e=>y(this,void 0,void 0,(function*(){const{apiVersion:t,kind:n,metadata:i}=e,{group:r,version:s}=(0,c.cR)(t);return{group:r,version:s,kind:n,name:i.name,namespace:i.namespace||o}})))));return{kuiSourceRef:i,resourcesToWaitFor:s}}))}(w,e,g):yield function(e,t,n,o){return y(this,void 0,void 0,(function*(){const[i,r,s]=t;if(o===v.d.OfflineLike)return{resourcesToWaitFor:t.slice(1).map((e=>e.split(/\./))).map((([e,t,o])=>({group:t,version:o,kind:i,name:e,namespace:n})))};if("create"===e)return/secret(s)?/i.test(i)?{resourcesToWaitFor:[{name:s,kind:i,namespace:n}]}:{resourcesToWaitFor:t.slice(1).map((e=>e.split(/\./))).map((([e,t,o])=>({group:t,version:o,kind:i,name:e,namespace:n})))};const[a,c,u]=r.split(/\./);return{resourcesToWaitFor:[{group:c,version:u,kind:i,name:a,namespace:n}]}}))}(t,p||e.argvNoOptions.slice(e.argvNoOptions.indexOf(t)+1),g,u);if(b("resourcesToWaitFor",i),1===i.length){const{group:t,version:n,kind:r,name:s}=i[0];if((0,f.Cr)({apiVersion:`${t}/${n}`,kind:r})){const i=(0,d.QG)(e,`${o||"kubectl"} get ${r}.${n}.${t} ${s} ${h?"--watch":""}`);return e.REPL.qexec(i)}}try{const n=(yield Promise.all(i.map((t=>y(void 0,void 0,void 0,(function*(){return Object.assign(t,{explainedKind:yield(0,a.St)(o||"kubectl",e,t.kind)})})))))).reduce(((e,t)=>{const n=e.find((e=>e.namespace===t.namespace&&e.explainedKind.kind===t.explainedKind.kind&&e.explainedKind.version===t.explainedKind.version));return n?n.names.includes(t.name)||n.names.push(t.name):e.push({names:[t.name],namespace:t.namespace,explainedKind:t.explainedKind}),e}),[]),s=yield(0,l.Z)(e,n,u,o,k,h);if(s)return b("using direct/status response"),(0,r.isTable)(s)?"delete"!==t?Object.assign(s,{kuiSourceRef:O}):s:s.join("\n")}catch(e){console.error("Error with direct/status. Falling back on polling implementation.",e)}if(b("backup plan: using old status poller"),h)return Object.assign(new x(e,e.tab,i,u,`-n ${g} ${(0,d.zr)(e)}`,o).initialTable(),{kuiSourceRef:"delete"!==t?O:void 0})}catch(e){if(console.error("error constructing StatusWatcher",e),h)return i}}))},96218:(e,t,n)=>{"use strict";n.d(t,{l:()=>k,Z:()=>x});var o=n(11227),i=n.n(o),r=n(73258),s=n.n(r),a=n(51173),c=n(21858),u=n(65187),l=n(53156),d=n(79895),p=n(67808),f=n(54476),m=n(48764).Buffer,h=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const v=(0,a.i18n)("plugin-kubectl","events"),y=i()("plugin-kubectl/controller/watch/watcher");function g(e,t){const n=e.split(/\n/).map((e=>{const t=e.split(/\|/);return t.slice(0,t.length-1)}));let o=n.length;for(;--o>=0&&n[o].length!==t;);if(o<0)return{leftover:e,rows:[]};if(o===n.length-1)return{leftover:void 0,rows:n.map((e=>e.map((e=>({key:e,value:e}))))).filter((e=>e.length>0))};{let t=e.length;for(;--t>=0&&"\n"!==e.charAt(t););return{leftover:e.slice(t),rows:n.slice(0,o+1).map((e=>e.map((e=>({key:e,value:e}))))).filter((e=>e.length>0))}}}function b(e){return null!=e}class k{constructor(e,t,n,o,i,r,s){this.args=e,this.command=t,this.kindByUser=n,this.name=o,this.namespace=i,this.watchOnly=r,this.pusher=s,this.shouldAbort=!1,this.ptyJob=[],this.now=Date.now()}abort(){this.shouldAbort=!0,this.ptyJob&&this.ptyJob.forEach((e=>e.abort()))}onPTYEventInit(e){return y("onPTYEventInit"),this.ptyJob.push(e),e=>h(this,void 0,void 0,(function*(){if("string"==typeof e){const t=this.eventLeftover?this.eventLeftover+e:e;this.eventLeftover=void 0;const n=g(t,4);y("rawData",t),this.eventLeftover="\n"===n.leftover?void 0:n.leftover;const o=n.rows.filter(b).filter((e=>e[1]&&(!this.name||0===this.name.length||this.name.includes(e[1].value)))).sort(((e,t)=>new Date(e[0].value).getTime()-new Date(t[0].value).getTime())),i=o.map((e=>{const t=new Date(e[0].value).getTime(),n=this.now-t;return isNaN(n)?v("<unknown>"):v("ago",n<=0?s()(0):s()(n>=0?n:0,{compact:!0}).toString())})),r=o.map(((e,t)=>{const n=e[1].value,o=e[2].value,r=e[3].value,s=`#kuiexec?command=${encodeURIComponent((0,l.QG)(this.args,`kubectl get event ${r} -o yaml`))}`;return`[[${i[t]}]](${s}) **${n}**: ${o}`}));r&&this.pusher.footer(r)}}))}onPTYInitDone(){this.shouldAbort&&this.abort()}init(){return h(this,void 0,void 0,(function*(){const e=`--field-selector=involvedObject.kind=${yield(0,u.ZK)(this.command,this.args,this.kindByUser)}`,t=this.watchOnly?"--watch-only":"-w",n=(0,l.QG)(this.args,`${this.command} get events ${t} -n ${this.namespace} ${e} --no-headers -o jsonpath='{.lastTimestamp}{"|"}{.involvedObject.name}{"|"}{.message}{"|"}{.metadata.name}{"|\\n"}'`.replace(/^k(\s)/,"kubectl$1"));this.args.REPL.qexec(`sendtopty ${n}`,this.args.block,void 0,{quiet:!0,replSilence:!0,echo:!1,onReady:this.onPTYInitDone.bind(this),onInit:this.onPTYEventInit.bind(this)}).catch((e=>{y("pty event error",e)}))}))}}class w{constructor(e,t=(0,l.QI)(e)){this.args=e,this.output=t,this.nCols=4,this.ptyJob=[],this.limit=e.parsedOptions.limit||(e.execOptions.data&&"object"==typeof e.execOptions.data&&!m.isBuffer(e.execOptions.data)&&"number"==typeof e.execOptions.data.limit?e.execOptions.data.limit:void 0)}abort(){this.ptyJob&&(this.ptyJob.forEach((e=>e.abort())),this.ptyJob=[])}groupByNamespace(e){return e.reduce(((e,t)=>{const n=t[3].value||"default",o=e[n]||[];return e[n]||(e[n]=o),o.push(t),e}),{})}allNamespaceOverride(e,t,n){return h(this,void 0,void 0,(function*(){const o=yield this.args.REPL.qexec(`sendtopty ${t.replace(/^k(\s)/,"kubectl$1")}`),i=(0,p.hO)(o.split(/^(?=LAST SEEN|NAMESPACE|NAME\s+)/m))[0].map(((t,n)=>0===n?[{key:"NAMESPACE",value:"NAMESPACE"}].concat(t):[{key:"NAMESPACE",value:e}].concat(t))),r=(0,d.fY)(this.args),s="k"===r?"kubectl":r;return(0,p.xM)(s,"get",n,this.args,i)}))}getRowsForNamespace(e,t,n,o){const i=(0,l.wU)(this.args,`get ${(0,c.M5)(e,t)} ${o.join(" ")} -n ${n} ${this.output?`-o ${this.output}`:""}`);return(0,l.Dk)(this.args.parsedOptions)?this.allNamespaceOverride(n,i,t):this.args.REPL.qexec(i).catch((e=>{404!==e.code&&console.error(e),"string"==typeof o?this.pusher.offline(o):o.forEach((e=>this.pusher.offline(e)))}))}getRowsForUser(e){return h(this,void 0,void 0,(function*(){if(0===e.length)return;const t=e[0][1].value,n=e[0][2].value,o=this.groupByNamespace(e),i=(yield Promise.all(Object.keys(o).map((e=>{const i=o[e].map((e=>e[0].value));return this.getRowsForNamespace(n,t,e,i)})))).filter(b);return i.length>0?{title:i[0].title,header:i[0].header,body:(0,a.flatten)(i.map((e=>e.body)))}:void 0}))}isDone(e){const t=e.attributes.find((e=>/STATUS/i.test(e.key)));return t&&t.css&&t.css===f.Z.Blue}onPTYInit(e){y("onPTYInit"),this.ptyJob.push(e);let t=this.limit;const n={};return e=>h(this,void 0,void 0,(function*(){if("string"==typeof e){if(/not found/.test(e))return void this.pusher.allOffline();const o=this.leftover?this.leftover+e:e;this.leftover=void 0;const i=g(o,this.nCols);this.leftover="\n"===i.leftover?void 0:i.leftover;const{rows:r}=i,s=yield this.getRowsForUser(r);if(s){s.header&&this.pusher.header(s.header);const e=r[0][2].value,o=r[0][1].value,i="v1"===e&&"Event"===o;s.body.forEach((e=>{if(e.isDeleted)this.pusher.offline(e.name);else{this.pusher.update(e,!0,!i);const o=e.attributes.find((e=>/NAME/i.test(e.key))),r=o?o.value:e.name;this.limit&&!n[r]&&this.isDone(e)&&(n[r]=!0,t--)}})),this.pusher.batchUpdateDone(),this.limit&&t<=0&&(y("Aborting PTY channel, due to having observed the expected number of completions"),this.abort())}}else console.error("unknown streamable type",e)}))}init(e){return h(this,void 0,void 0,(function*(){this.pusher=e;const t=(0,l.QG)(this.args,this.args.command.replace(/^k(\s)/,"kubectl$1").replace(/--limit \d+/g,"").replace(/--sort-by=\S+/g,"").replace(/--watch=true|-w=true|--watch-only=true|--watch|-w|--watch-only/g,"--watch").replace(new RegExp(`(-o|--output)(\\s+|=)${this.output}`),"")+' -o jsonpath=\'{.metadata.name}{"|"}{.kind}{"|"}{.apiVersion}{"|"}{.metadata.namespace}{"|\\n"}\'');this.args.REPL.qexec(`sendtopty ${t}`,this.args.block,void 0,{quiet:!0,replSilence:!0,echo:!1,onInit:this.onPTYInit.bind(this)}).catch((e=>{y("pty error",e)}));const n=(0,d.fY)(this.args),o=yield(0,l.D_)(this.args),i=this.args.argvNoOptions[this.args.argvNoOptions.indexOf("get")+1];if((0,l.id)(this.args)||this.args.parsedOptions["field-selector"])y("event watcher does not support label and field selector");else{const e=new k(this.args,n,i,(0,l.vI)(i,this.args),o,!1,this.pusher);e.init(),this.ptyJob.push(e)}}))}}function x(e){return h(this,void 0,void 0,(function*(){try{const t=(0,l.QG)(e,e.command.replace(/^k(\s)/,"kubectl$1").replace(/--watch=true|-w=true|--watch-only=true|--watch|-w|--watch-only/g,"")),n=yield e.REPL.qexec(t).catch((t=>{if(404!==t.code)throw t;{const n=e.argvNoOptions,o=n.indexOf("get")+1,i=n[o],r=n[o+1];if(/doesn't have a resource type/i.test(t.message))throw t;if(i&&r)throw t;return{body:[]}}}));return"string"==typeof n?e.execOptions.initialResponse||n:Object.assign({},n,{breadcrumbs:n.breadcrumbs||(yield(0,p.Qt)(n.title,e)),title:n.title||(yield(0,u.ZK)((0,d.fY)(e),e,e.argvNoOptions[e.argvNoOptions.indexOf("get")+1])),watch:new w(e,void 0)})}catch(t){const n=e.execOptions.initialResponse||t.message;throw t.message=n,t}}))}},19945:(e,t,n)=>{"use strict";n.d(t,{_b:()=>N.ZP,VR:()=>i.Z,zh:()=>a.Z,pb:()=>p.Z,Lr:()=>E.L,Dq:()=>S.Dq,q1:()=>$.q,uV:()=>l,fF:()=>s.fF,I$:()=>s.I$,d1:()=>s.d1,A:()=>s.A,gc:()=>x.gc,t$:()=>v.t$,g8:()=>d.g8,dP:()=>O.d,xf:()=>C.xf,LG:()=>g.LG,id:()=>p.i,xM:()=>h.xM,kJ:()=>b.kJ,uE:()=>b.uE,Kz:()=>x.Ao,fY:()=>y.fY,ZO:()=>m.ZO,Yi:()=>f.Yi,ZK:()=>k.ZK,Z7:()=>m.id,xT:()=>m.xT,D_:()=>m.D_,UU:()=>m.UU,Yn:()=>x.Yn,Rt:()=>o.Rt,Dk:()=>m.Dk,oe:()=>o.oe,Bv:()=>o.Bv,Ib:()=>o.Ib,k1:()=>o.th,Xk:()=>o.Xk,lN:()=>v.lN,$z:()=>C.$z,rI:()=>C.rI,hO:()=>h.hO,VP:()=>R.VP,Tn:()=>C.z2,hM:()=>w.z2,QG:()=>m.QG});var o=n(21274),i=n(54476),r=n(51173),s=n(21045),a=n(81634),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const u=(0,r.i18n)("plugin-kubectl");function l(e,t){return c(this,void 0,void 0,(function*(){const n=e.argv[0]===a.Z?e.argv[1]:e.argv[0],o=(yield(0,s.d1)(e,void 0,t)).replace(/^ (.*)/gm,"        $1");return{apiVersion:"kui-shell/v1",kind:"NavResponse",breadcrumbs:[{label:n}],links:[],menus:[{label:u("Usage"),items:[{mode:u("Introduction"),content:o,contentType:"text/markdown"}]}]}}))}var d=n(65458),p=n(40227),f=n(63744),m=n(53156),h=(n(31276),n(67808)),v=(n(68281),n(8749)),y=n(79895),g=n(65402),b=n(21858),k=n(65187),w=n(28040),x=n(26472),O=n(14867),S=n(28882),$=n(80625),E=n(14945),C=n(35501),R=n(70690),N=n(40714)},21274:(e,t,n)=>{"use strict";n.d(t,{pL:()=>r,Yy:()=>s,k1:()=>a,BJ:()=>c,ri:()=>u,Ib:()=>l,xS:()=>d,l7:()=>p,th:()=>f,me:()=>m,Cr:()=>h,Yc:()=>v,MN:()=>y,_E:()=>g,cO:()=>b,Rt:()=>k,oe:()=>w,Xk:()=>x,Bv:()=>O,MP:()=>S,O:()=>$,Oc:()=>E,UG:()=>C,iN:()=>R,Cb:()=>N,ko:()=>P});var o=n(58253),i=n(48764).Buffer;function r(e){return"string"==typeof e.metadata.resourceVersion}function s(e,t){return e.apiVersion===t.apiVersion&&e.kind===t.kind&&e.metadata.name===t.metadata.name&&e.metadata.namespace===t.metadata.namespace&&r(e)&&r(t)&&e.metadata.resourceVersion===t.metadata.resourceVersion}function a(e){if(!e.metadata)return!1;const{ownerReferences:t}=e.metadata;return t&&Array.isArray(t)&&1===t.length&&"string"==typeof t[0].apiVersion&&"string"==typeof t[0].kind&&"string"==typeof t[0].name}function c(e){return"string"==typeof e.kuiRawData}function u(e){return void 0!==e.metadata&&void 0!==e.metadata.namespace}function l(e){const t=e;return void 0!==t&&!0===t.isKubeResource&&void 0!==t.apiVersion&&t.apiVersion!==o.Z&&void 0!==t.kind}function d(e){return void 0!==e&&void 0!==e.summary}function p(e){return l(e)&&(d(e)||void 0!==e.kind&&"List"!==e.kind&&"CustomResourceDefinition"!==e.kind)}function f(e){return l(e)&&"v1"===e.apiVersion&&"Pod"===e.kind}function m(e){return l(e)&&"v1"===e.apiVersion&&"Namespace"===e.kind}function h(e){return"batch/v1"===e.apiVersion&&"Job"===e.kind}function v(e){return l(e)&&"Deployment"===e.kind&&("extensions/v1beta1"===e.apiVersion||"apps/v1"===e.apiVersion)}function y(e){return l(e)&&("extensions/v1beta1"===e.apiVersion||"apps/v1"===e.apiVersion)&&"ReplicaSet"===e.kind}function g(e){const t=e;return void 0!==t.involvedObject&&"string"==typeof t.involvedObject.apiVersion&&"string"==typeof t.involvedObject.kind&&"string"==typeof t.involvedObject.name}function b(e){return l(e)&&"v1"===e.apiVersion&&"Event"===e.kind}function k(e){return l(e)&&!b(e)&&!e.isSimulacrum}function w(e){return l(e)&&"v1"===e.apiVersion&&/List$/.test(e.kind)}function x(e){return l(e)&&"v1"===e.apiVersion&&"PodList"===e.kind}function O(e,t){return w(e)&&e.items.length>0&&t(e.items[0])}function S(e){return l(e)&&("apiextensions.k8s.io/v1"===e.apiVersion||"apiextensions.k8s.io/v1beta1"===e.apiVersion)&&"CustomResourceDefinition"===e.kind}function $(e){return l(e)&&"v1"===e.apiVersion&&"ConfigMap"===e.kind}function E(e){return"CustomResourceDefinition"===e||"Namespace"===e||"Node"===e}function C(e){return"v1"===e.apiVersion&&"Node"===e.kind}function R(e){const t=e;return"meta.k8s.io/v1"===t.apiVersion&&"Table"===t.kind}function N(e){if(i.isBuffer(e)||"string"==typeof e)return!1;{const t=e;return"v1"===t.apiVersion&&"Status"===t.kind}}function P(e){return"v1"===e.apiVersion&&"Secret"===e.kind}},60965:(e,t,n)=>{"use strict";n.d(t,{d:()=>S,_:()=>N});const o="Available",i="Active",r="Online",s="Ready",a="Running",c="Completed",u="Succeeded",l="ProvisionedSuccessfully",d="Propagated",p="Subscribed",f="Deployed",m="ChannelReady",h="Addressable",v="Offline",y="Offline",g="Failed",b="Disparity",k="NotProvisioned",w="Unschedulable",x="ErrImagePull",O="PropagationFailed";var S;!function(e){e[e.NotPendingLike=0]="NotPendingLike",e[e.OnlineLike=1]="OnlineLike",e[e.OfflineLike=2]="OfflineLike"}(S||(S={}));const $={},E=e=>e.reduce(((e,t)=>(e[t]=!0,e)),{});$[S.OnlineLike]=E([o,i,r,s,a,l,f,m,h,c,d,p,u]);const C=e=>$[S.OnlineLike][e];$[S.OfflineLike]=E([v,y,g,b,k,w,O,x]);const R=e=>!!$[S.OfflineLike][e];function N(e,t){var n;return e===g||t===S.NotPendingLike&&!(!C(n=e)&&!R(n))||t===S.OnlineLike&&C(e)||t===S.OfflineLike&&R(e)}},54476:(e,t,n)=>{"use strict";var o;function i(e){return e.indexOf(o.Red)>=0?o.Red:e.indexOf(o.Yellow)>=0?o.Yellow:e.indexOf(o.Blue)>=0?o.Blue:e.indexOf(o.Green)>=0?o.Green:o.Gray}n.d(t,{o:()=>i,Z:()=>r}),function(e){e.Gray="gray-background",e.Red="red-background",e.Yellow="yellow-background",e.Blue="blue-background",e.Green="green-background"}(o||(o={}));const r=o},65402:(e,t,n)=>{"use strict";n.d(t,{dc:()=>N,LG:()=>P,H4:()=>T,MJ:()=>I,Q:()=>R,Cg:()=>$});var o=n(11227),i=n.n(o),r=(n(26470),n(64484)),s=n.n(r),a=n(51173);var c=n(19945),u=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const l=i()("plugin-kubectl/client/proxy"),d={oc:void 0,kubectl:void 0};function p(){try{this.process&&(l("killing kubectl proxy",this.port),this.process.kill()),function(e){try{"function"==typeof e&&((0,a.offQuit)(e),(0,c.$z)(e))}catch(e){console.error("Error unregistering kubectl proxy onQuit",e)}}(this.onQuitHandler)}catch(e){console.error("Error stopping kubectl proxy",e)}}function f(e){return u(this,void 0,void 0,(function*(){const{spawn:t}=yield Promise.resolve().then(n.t.bind(n,32383,23));return new Promise(((n,o)=>{const i=(r=8001,s=0)=>{try{l("attempting to spawn kubectl proxy on port",r);const c=t(e,["proxy","--keepalive=120s","--port",r.toString()]);let u,f=!1;c.on("error",(e=>{console.error("Error spawning kubectl proxy",e),o(e)})),c.stdout.on("data",(e=>{const t=e.toString();l("stdout",t),/Starting to serve/.test(t)&&(l("succeessfully spawned kubectl proxy on port",r),u=function(e){try{const t=p.bind(e);return(0,a.onQuit)(t),Object.assign(e,{onQuitHandler:t})}catch(e){console.error("Error registering kubectl proxy onQuit",e)}}({process:c,port:r}),n(u))}));let m="";c.stderr.on("data",(e=>{const t=e.toString();/address already in use/.test(t)&&s<1e3?(f=!0,i(r+1,s+1)):(l("stderr",t),m+=t)})),c.on("exit",((t,n)=>{l("kubectl proxy has exited with code",t||n),void 0!==d[e]&&s>=1e3?(console.error(`kubectl proxy exited unexpectedly with exitCode=${t||n}`),o(new Error(m))):d[e]&&(l("marking proxy as terminated"),u&&(u.process=void 0),f||(d[e]=void 0))}))}catch(e){console.error("Error establishing kubectl proxy",e),o(e)}};i()}))}))}function m(e){return void 0!==d[e]}function h(e){return u(this,void 0,void 0,(function*(){return m(e)||(l("attempting to start proxy"),function(e){if(!d[e]){const t=f(e);d[e]=t,t.then((e=>(0,c.rI)((t=>{"SetNamespaceOrContext"===t&&e.onQuitHandler()}))))}d[e]}(e)),{baseUrl:m(e)?`http://localhost:${(yield d[e]).port}`:void 0}}))}n(53156);var v=n(7716),y=n(48764).Buffer,g=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const b=(0,a.i18n)("plugin-kubectl"),k=i()("plugin-kubectl/util/fetch-file"),w=/http(s)?:\/\//,x=/^openshift:\/\//,O=/^kubernetes:\/\//;function S(e){return g(this,void 0,void 0,(function*(){if(O.test(e)){const{baseUrl:t}=yield h("kubectl");return e.replace(O,t)}if(x.test(e)){const{baseUrl:t}=yield h("oc");return e.replace(x,t)}return e}))}function $(e,t,n,o){return g(this,void 0,void 0,(function*(){if((0,a.inBrowser)()&&(0,a.hasProxy)())k("routing openStream request to proxy",t),yield e.REPL.rexec(`_openstream ${(0,a.encodeComponent)(t)}`,Object.assign({},{onInit:n.onInit,onReady:n.onReady,onExit:n.onExit,data:{headers:o}})),k("routed openStream to proxy: done",t);else{const e=yield S(t);k("routing openStream request to endpoint",e);const i=s().get(e,{headers:o,parse:!1}),r=n.onInit({abort:()=>{k("abort requested",typeof i.destroy),"function"==typeof i.destroy&&i.destroy(),"function"==typeof n.onExit&&(k("sending onExit"),n.onExit(0))},xon:()=>i.resume(),xoff:()=>i.pause(),write:()=>{console.error("Unsupported Operation: write")}});i.on("error",(e=>{"ERR_STREAM_DESTROYED"!==e.code&&console.error("stream suddenly died",e)})),function(e,t,n){let o=!1,i=!1,r=0,s="";n&&e.on("done",n),t&&e.on("data",(e=>{const n=e.toString();for(let e=0;e<n.length;e++){const a=n.charAt(e),c=o;if(o=!1,s+=a,i||"{"!==a||r++,c||'"'!==a||(i=!i),c||"\\"!==a||(o=!0),!i&&"}"===a&&0==--r){let e;try{e=JSON.parse(s)}catch(e){console.error("Error parsing bundle",s,e)}try{t(e)}catch(t){console.error("Error processing bundle",e,t)}s=""}}}))}(i,yield r,n.onExit)}}))}function E(e,t,n,o=0){return g(this,void 0,void 0,(function*(){if((0,a.inBrowser)()){if((0,a.inBrowser)()){if((0,a.hasProxy)()){k("fetch via proxy");return{statusCode:200,body:(yield e.rexec(`_fetchfile ${(0,a.encodeComponent)(t)}`,{data:n})).content[0]}}throw new Error(b("Unable to fetch remote file"))}}else{const i=n&&n.method||"get",r=Object.assign({connection:"keep-alive"},n.headers);if(k("fetch via needle",i,r),v.env.TRAVIS_CHAOS_TESTING)throw new Error("nope");try{const{statusCode:e,body:o}=yield s()(i,yield S(t),n.data,{json:!0,follow_max:10,headers:r});return k("fetch via needle done",e),{statusCode:e,body:o}}catch(i){if("ECONNREFUSED"===i.code&&o<10)return k("retrying due to ECONNREFUSED"),new Promise(((i,r)=>{setTimeout((()=>g(this,void 0,void 0,(function*(){try{E(e,t,n,o+1).then(i,r)}catch(e){r(e)}}))),50)}));throw i}}}))}function C(e,t,n){return g(this,void 0,void 0,(function*(){k("fetchRemote",t,n);const o=()=>E(e,t,n).then((e=>{if(0===e.statusCode||200===e.statusCode||"string"!=typeof e.body)return e.body;{const t=new Error(e.body.toString());throw t.code=e.statusCode,t}})),i=e=>t=>g(this,void 0,void 0,(function*(){if(/timeout/.test(t.message)||/hang up/.test(t.message)||/hangup/.test(t.message))return k("retrying",t),yield new Promise((t=>setTimeout(t,e))),o();throw t}));return o().catch(i(500)).catch(i(1e3)).catch(i(5e3))}))}function R(e){const t=e;return"string"!=typeof e&&!y.isBuffer(e)&&"string"==typeof t.error}function N(e,t,n){return g(this,void 0,void 0,(function*(){const o=t.split(/,/);k("fetchFile",o);const i=Date.now(),r=yield Promise.all(o.map(((t,o)=>g(this,void 0,void 0,(function*(){if(w.test(t)||O.test(t)||x.test(t))return k("fetch remote",t),C(e,t,Object.assign({},n,{data:Array.isArray(n.data)?n.data[o]:n.data})).catch((e=>{if(n&&n.returnErrors)return{error:e.message||JSON.stringify(e)};throw e}));{const n=t;k("fetch local",n);return(yield e.rexec(`vfs fstat ${e.encodeComponent(n)} --with-data`)).content.data}})))));return k("fetchFile done",Date.now()-i),r}))}function P(e,t,n){return g(this,void 0,void 0,(function*(){return(yield N(e,t,{headers:n})).map((e=>{try{return e?"string"==typeof e?e:y.isBuffer(e)?e.toString():JSON.stringify(e):void 0}catch(t){return console.error("Unable to convert fetched file to string",t,e),""}}))}))}function D(e,t){return g(this,void 0,void 0,(function*(){return(yield e.rexec(`_fetchfile ${e.encodeComponent(t)} --kustomize`)).content}))}function T(e,t,n){return g(this,void 0,void 0,(function*(){const o=n?`${(0,a.encodeComponent)(t)} ${(0,a.encodeComponent)(t)}/**/*.{yaml,yml}`:t,i=new Set((yield e.REPL.rexec(`vfs ls ${o}`)).content.map((e=>e.path)));return(yield P(e.REPL,0===i.size?t:Array.from(i).join(","))).map(((e,n)=>{if(e)return{filepath:0===i.size?t:Array.from(i)[n],data:e}}))}))}function I(e,t){return g(this,void 0,void 0,(function*(){const[{safeLoad:o},{join:i},r]=yield Promise.all([n.e(3320).then(n.t.bind(n,93320,23)),Promise.resolve().then(n.t.bind(n,26470,23)),D(e.REPL,t)]),s=o(r.data);if(s.resources){const n=s.resources.map((e=>(0,a.encodeComponent)(r.dir?i(r.dir,e):e))).join(" "),o=yield T(e,n);return{customization:{filepath:t,data:r.data,contentType:"yaml",isFor:"k"},templates:o.map((({filepath:e,data:t})=>({filepath:e,data:t,contentType:"yaml",isFor:"k"})))}}}))}},8749:(e,t,n)=>{"use strict";n.d(t,{lN:()=>g,t$:()=>b});var o=n(11227),i=n.n(o),r=n(51173),s=(n(79895),n(53156)),a=n(81634),c=n(21045),u=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const l=i()("kubectl/help"),d=(0,r.i18n)("plugin-kubectl"),p=e=>e.replace(/^\s*([^.]+)[.]\s*$/,"$1").trim();function f({command:e,docs:t}){return`\n### Example\n\`\`\`\n${e}\n\`\`\`\n\n${t}\n`}function m(e,t,n,o){const i=`### ${e.replace(/:$/,"")}`;return t.reduce(((e,t)=>e+`\n#### [${t.command}](#kuiexec?command=${encodeURIComponent(function(e,t,n){return`${e}${t?` ${t}`:""} ${n} -h`}(n,o,t.command))})\n${t.docs}\n`),i)}function h(e,t=!0,...n){return e?[{label:e,command:t?`${n.join(" ")} ${e} -h`:void 0}]:[]}const v=(e,t,n,o,i)=>{const s=e.match(/^(Use\s+.+)$/gm),a=s?e.substring(0,s.index):e,c=s&&s.filter((e=>!e.includes('Use "kubectl options"'))).map((e=>e.replace(/"([^"]+)"/g,((e,t)=>`[${t}](#kuiexec?command=${encodeURIComponent(t)} "Execute ${t}")`)))).join("\n"),u=a.split(/\n\n([^'\s].*:)\n(?!\n)/),v=s&&0!==s.length?u[0].indexOf(s[0]):u[0].length,y=u[0].slice(0,v),g=e=>({title:e.title,rows:e.content.split(/[\n\r]/).filter((e=>e)).map((t=>{const i=t.match(/\s*((.+:)|\S+)\s+(.*)/);if(i&&4===i.length){const t=i[1],r=i[3];return{command:t.replace(/^\s*-\s+/,"").replace(/:\s*$/,""),docs:r&&r.replace(/^\s*:\s*/,""),commandPrefix:/Commands/i.test(e.title)&&`${n} ${o||""}`,noclick:!e.title.match(/Common actions/i)&&!e.title.match(/Commands/i)}}})).filter((e=>e))});if("options"===o){const e=y.split("\n\n"),i=g({title:e[0],content:e[1].replace(/^\n/,"")});return t.execOptions.type===r.ExecType.TopLevel?((e,t,n,o,i=r.TableStyle.Light)=>({noSort:!0,style:i,header:{name:o,attributes:[{value:"DOCS"}]},body:e.map((({command:e,docs:i})=>({name:e,outerCSS:"option-width",css:"COMMAND"===o?"clickable sub-text":"sub-text",onclick:"COMMAND"===o?`${t}${n?` ${n}`:""} ${e} -h`:void 0,attributes:[{key:"DOCS",value:i,css:"map-value"}]})))}))(i.rows,n,o,"OPTIONS",r.TableStyle.Medium):m(i.title,i.rows,n,o)}const b=u.slice(1).reduce(((e,t,n,o)=>(n%2==0&&e.push({title:o[n],content:o[n+1].replace(/^\n/,"")}),e)),[]),k=b.find((({title:e})=>"Aliases:"===e)),w=b.filter((({title:e})=>"Usage:"===e)),x=b.find((({title:e})=>"Examples:"===e)),O=b.filter((({title:e})=>"Usage:"!==e&&"Examples:"!==e)).map(g),S=(x?x.content:"").split(/^\s*(?:#\s+)/gm).map((e=>e.trim())).filter((e=>e)).map((e=>{const t=e.match(/(.*)[\n\r]([\s\S]+)/);if(t&&3===t.length){const[,e,n]=t,o=p(e),i=p(n),r=i.split(/[\n\r]/).length>1;return{command:r?o:i,docs:r?i:o}}return{copyToNextLine:e}})).reduce(((e,t,n,o)=>{for(let e=n-1;e>=0&&o[e].copyToNextLine;e--)t.docs=`${o[e].copyToNextLine}\n${t.docs}`;return t.copyToNextLine||e.push(t),e}),[]).filter((e=>e));if(0===y.length)return e;const $=[(E=d("Usage"),{label:E,items:[{mode:d("Introduction"),content:y.replace(/\n\s*(IMPORTANT:)([^\n]+)/,"\n> **$1**$2").replace(/(\s)(NOT)(\s)/g,"$1**$2**$3").replace(/^(.{1-15}):$/gm,"##### $1\n").replace(/(:\n\n\s*)((([^,\n])+,)+[^,\n]+)/g,((e,t,n)=>`${t}${n.split(/,/).map((e=>e.startsWith("-")?e:` - ${e}`)).join("\n")}\n`)).concat("\n\n").replace(/(\s--\S+)/g,"`$1`").replace(/\n\n[+-]+\n/g,"\n\n").replace(/^\+--/gm,"---").replace(/--\+$/gm,"---").replace(/--\+/g,"--|").replace(/^[+-]+$/gm,"").replace(/\|\n[|-]+\n\n/g,"|\n\n").replace(/^\n*([^\n.]+)(\.?)/,"### About\n#### $1").replace(/\n\s*(Find more information at:)\s+([^\n]+)/,"").concat(k?`### Aliases\n${k.content}`:"").concat(w&&0!==w.length?`\n### Usage\n\`\`\`\n${w[0].content.slice(0,w[0].content.includes("\n")?w[0].content.indexOf("\n"):void 0).trim()}\n\`\`\`\n`:"").concat(c&&c.length>0?`### Guide\n${c}`:""),contentType:"text/markdown"}].concat(""===o&&"kubectl"===n?[{mode:d("Options"),contentType:"text/markdown",contentFrom:"kubectl options"}]:O.some((e=>/Flags|Options/i.test(e.title)))?O.filter((e=>/Flags|Options/i.test(e.title))).map((e=>({mode:e.title.replace(":",""),content:m(e.title,e.rows,n,o),contentType:"text/markdown"}))):[])}),(()=>{if(O.some((e=>/command/i.test(e.title))))return{label:d("Commands"),items:O.filter((e=>/command/i.test(e.title))).map((e=>({mode:e.title.replace(/Command(s)/,"").replace(/:$/,"")||d("Basic"),content:m(e.title,e.rows,n,o),contentType:"text/markdown"})))}})(),(()=>{const e=O.filter((e=>!(/command/i.test(e.title)||/Flags|Options/i.test(e.title))));if(e.length>0)return{label:d("Miscellaneous"),items:e.map((e=>({mode:e.title.replace(/:$/,""),content:m(e.title,e.rows,n,o),contentType:"text/markdown"})))}})(),(()=>{if(S&&S.length>0)return{label:d("Examples"),items:S.map((e=>({mode:e.command.replace(new RegExp(`^${n}\\s+${i?o:""}`),""),contentType:"text/markdown",content:f(e)})))}})()].filter((e=>e));var E;l("menus",$);return{apiVersion:"kui-shell/v1",kind:"NavResponse",menus:$,breadcrumbs:h(n,!!o||!!i).concat(h(o,!!i,n)).concat(h(i,!1,n,o)),links:[(e=>{const t="Find more information at: ";if(e.includes(t))return{label:d("More Information"),href:e.split(t)[1].split("\n")[0]}})(y)].filter((e=>e))}},y=/^k(ubectl)?$/,g=e=>(0,s.$)(e)||(e=>1===e.argv.length&&y.test(e.argv[0])||2===e.argv.length&&e.argv[0]===a.Z&&y.test(e.argv[1]))(e);function b(e,t,n=c.W5){return u(this,void 0,void 0,(function*(){const o=yield(0,c.ir)(t,n,e),i=t.argvNoOptions.length>=2?t.argvNoOptions[1]:"",r=t.argvNoOptions.length>=3?t.argvNoOptions[2]:"",a="help"===i,u=a&&(0,s.kr)(t),l=a&&!u?r:i,d=a?void 0:r;return((e,t,n,o,i)=>{try{return v(e,t,n,o,i)}catch(t){return console.error("Internal Error parsing help output",t),e}})(o.content.stdout||o.content.stderr,t,e,l,d)}))}},31276:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(21274);function i(e){const t=e&&e.metadata,n=t&&t.labels&&t.labels["app.kubernetes.io/name"]&&t.labels["app.kubernetes.io/instance"]&&`${t.labels["app.kubernetes.io/instance"]}-${t.labels["app.kubernetes.io/name"]}`||t&&t.labels&&t.labels.app||(0,o._E)(e)&&e.involvedObject.name;if(n){const o=t&&t.labels&&t.labels.version,i=`(^${n})[-.](${o}-)?([0-9a-zA-Z]+-.+|[0-9a-z]{16})`,r=e.metadata.name.match(new RegExp(i)),s=r&&r[1],a=r&&r[3];if(s&&a)return{app:n,name:s,nameHash:a,version:o}}const i=t&&t.labels&&t.labels["pod-template-hash"];if(i){const n=t&&t.labels&&t.labels.version,o=`(.*)-(${i}.*$)`,r=e.metadata.name.match(new RegExp(o)),s=r&&r[1],a=r&&r[2];if(s&&a)return{name:s,nameHash:a,version:n}}return{}}},40714:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>d});n(78805);function o(e){return/m$/.test(e)?parseInt(e.replace(/m$/,""),10):1e3*parseInt(e,10)}const i=1024,r=1048576,s=1073741824,a=1099511627776,c=1024*a;function u(e){let t=2,n=1;if("0"===e)return 0;if(/Ei$/.test(e))n=0x1000000000000000;else if(/Pi$/.test(e))n=c;else if(/Ti$/.test(e))n=a;else if(/Gi$/.test(e))n=s;else if(/Mi$/.test(e))n=r;else if(/Ki$/.test(e))n=i;else{if(/\d+/.test(e))return parseInt(e);t=1}return parseInt(e.slice(0,e.length-t),10)*n}function l(e){return e<i?e.toString():e<10485760?(e/i).toFixed(0)+"Ki":e<10737418240?(e/r).toFixed(0)+"Mi":e<10*a?(e/s).toFixed(0)+"Gi":e<10*c?(e/a).toFixed(0)+"Ti":(e/c).toFixed(0)+"Pi"}const d={fractionOfMemory:function(e,t){return(u(e)/u(t)*100).toFixed(1)+"%"},reformatAsBytes:function(e){return l(u(e))},formatAsBytes:l,formatAsCpu:function(e){return e>1e4?(e/1e3).toFixed(0):`${e}m`},cpuShare:o,memShare:u,cpuFraction:function(e){return parseInt(e.replace(/%$/,""),10)}}},79895:(e,t,n)=>{"use strict";n.d(t,{fY:()=>i,HZ:()=>r,p2:()=>s});var o=n(81634);n(53156);Error;const i=e=>{const t=e.argvNoOptions[0]===o.Z?e.argvNoOptions[1]:e.argvNoOptions[0];return"k"===t?"kubectl":t},r=e=>e.argvNoOptions[0]===o.Z?3===e.argvNoOptions.length:2===e.argvNoOptions.length;function s(e){const t=e.split("\n"),n=t.map(((e,t)=>{if(e.includes("last-applied-configuration"))return t})).filter((e=>e));return t.filter(((e,t)=>!n.includes(t)&&!n.includes(t-1))).join("\n")}},52541:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(54476);const i={UNKNOWN:"",DEPLOYED:o.Z.Green,DELETED:"",SUPERSEDED:o.Z.Yellow,FAILED:o.Z.Red,DELETING:o.Z.Yellow,Offline:o.Z.Red,"Init:0/1":o.Z.Yellow,PodScheduled:o.Z.Yellow,PodInitializing:o.Z.Yellow,Initialized:o.Z.Yellow,Terminating:o.Z.Yellow,ImagePullBackOff:o.Z.Red,ErrImagePull:o.Z.Red,Error:o.Z.Red,UnexpectedAdmissionError:o.Z.Red,OOMKilled:o.Z.Red,1:o.Z.Green,0:o.Z.Red,"<none>":o.Z.Yellow,CrashLoopBackOff:o.Z.Red,Failed:o.Z.Red,PropagationFailed:o.Z.Red,Fail:o.Z.Red,Running:o.Z.Green,Pending:o.Z.Yellow,Succeeded:o.Z.Blue,Completed:o.Z.Gray,Unknown:"",Propagated:o.Z.Green,Subscribed:o.Z.Green,Ready:o.Z.Green,ProvisionedSuccessfully:o.Z.Green,Active:o.Z.Green,Online:o.Z.Green,NodeReady:o.Z.Green,Pulled:o.Z.Green,Rebooted:o.Z.Green,Started:o.Z.Green,Created:o.Z.Green,Scheduled:o.Z.Green,SuccessfulCreate:o.Z.Green,SuccessfulMountVol:o.Z.Green,ContainerCreating:o.Z.Yellow,Starting:o.Z.Yellow,NodeNotReady:o.Z.Yellow,Killing:o.Z.Red,Deleting:o.Z.Red,Pulling:o.Z.Yellow,BackOff:o.Z.Yellow,Unhealthy:o.Z.Red,FailedScheduling:o.Z.Red,FailedKillPod:o.Z.Red}},67808:(e,t,n)=>{"use strict";n.d(t,{O2:()=>c.Z,jT:()=>f,RA:()=>m,Qi:()=>h,VH:()=>v,hO:()=>g,QW:()=>b,Qt:()=>k,s7:()=>w,xM:()=>x,Lk:()=>O,k8:()=>S,rW:()=>E,jU:()=>C,ov:()=>R,ei:()=>N,Rx:()=>D,hb:()=>T});var o=n(51173),i=n(54476),r=n(21274),s=n(19945),a=n(53156),c=n(52541),u=n(48764).Buffer,l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const d=(0,o.i18n)("plugin-kubectl"),p=(e,t)=>e>=t?[]:new Array(t-e).fill(""),f={NAME:"entity-name-group",READY:"a-few-numbers-wide kui--hide-in-narrower-windows",KIND:"max-width-id-like entity-kind",NAMESPACE:"entity-name-group hide-with-sidecar not-a-name",MESSAGE:"not-too-compact",TYPE:"hide-with-sidecar",CLUSTER:"entity-name-group entity-name-group-narrow hide-with-sidecar",AUTHINFO:"entity-name-group entity-name-group-narrow hide-with-sidecar",REFERENCE:"entity-name-group entity-name-group-narrow hide-with-sidecar","CREATED AT":"hide-with-sidecar",CURRENT:"entity-name-group entity-name-group-extra-narrow text-center",DESIRED:"entity-name-group entity-name-group-extra-narrow text-center","LAST SEEN":"hide-with-sidecar entity-name-group-extra-narrow","FIRST SEEN":"hide-with-sidecar entity-name-group-extra-narrow",COUNT:"keep-with-sidecar",APIGROUP:"hide-with-sidecar",REVISION:"hide-with-sidecar",AGE:"hide-with-sidecar","PORT(S)":"entity-name-group entity-name-group-narrow hide-with-sidecar",SUBOBJECT:"entity-name-group entity-name-group-extra-narrow"},m={NAME:"entity-name",SOURCE:"lighter-text smaller-text",SUBOBJECT:"lighter-text smaller-text",MESSAGE:"somewhat-smaller-text pre-wrap","CREATED AT":"lighter-text smaller-text",AGE:"slightly-deemphasize","APP VERSION":"pre-wrap slightly-deemphasize",UPDATED:"slightly-deemphasize somewhat-smaller-text"},h={REASON:"badge",Reason:"badge",STATUS:"badge",Status:"badge"},v={Deployment:{READY:"badge",Ready:"badge"}},y=e=>e.replace(/\t/g,"   "),g=e=>e.map((e=>{const t=y(e.substring(0,e.indexOf("\n"))),n=t.split(/(\s\s)+\s?/).map((e=>e&&e.trim())).filter((e=>e)),o=[];for(let e=0,i=0;e<n.length;e++){const{offset:r,prefix:s}=0===e?{offset:0,prefix:""}:{offset:1,prefix:" "},a=t.indexOf(s+n[e]+" ",i);i=a<0?t.indexOf(" "+n[e],i):a,o.push(i+r)}return e.split(/\n/).filter((e=>e)).map(y).map((e=>((e,t,n)=>t.map(((o,i)=>({key:n&&n[i],value:e.substring(o,t[i+1]||e.length).trim()}))))(e,o,n)))}));function b(e){if(e){const[t,n]=e.split(/\//);return t&&n&&t===n?i.Z.Green:i.Z.Yellow}}function k(e,t){return l(this,void 0,void 0,(function*(){const n=yield(0,r.Oc)(e)?void 0:(0,a.wQ)(t)||(0,a.Dk)(t.parsedOptions)&&d("all")||t.execOptions.type===o.ExecType.TopLevel&&!(0,o.inBrowser)()&&(yield(0,s.Yi)(t));return n?[{label:n}]:void 0}))}function w(e){return"string"==typeof e?e[0]+e.slice(1).toLowerCase():e}const x=(e,t,n,r,s,u="NAME")=>l(void 0,void 0,void 0,(function*(){const{parsedOptions:l}=r,v="helm"===e&&"status"===t,y=v?"kubectl":e,g=("get"===t||"top"===t?"get":"helm"!==e||"list"!==t&&"ls"!==t?v?"get":"krew"===t?t:void 0:"get")||void 0,x="kubectl"!==y&&"oc"!==y||"get"!==g?"":"-o yaml",O=l.n||l.namespace,S=O?`-n ${(0,o.encodeComponent)(O)}`:"",$=s[0].findIndex((({key:e})=>"KIND"===e)),E=s[0].findIndex((({key:e})=>e===u)),C=s[0].findIndex((({key:e})=>"NAMESPACE"===e)),R=s.reduce(((e,t)=>Math.max(e,t.length)),0);let N;const P=s.map(((t,s)=>{const v=E>=0?t[E].value:"",k=v.split(/\//),w=k[1]||v,O=0===s||"CURRENT"!==t[0].key?"":"selected-entity",P="CURRENT"===t[0].key,D=P&&"*"===t[0].value,T=[D?"selected-row":""].filter((e=>e)),I=s>0&&D?"*":s>0&&P?"":k[1]||t[0].value;!P&&k[1]&&(N?N!==k[0]&&(N=void 0):N=k[0]);const Z=C>=0&&"helm"!==e&&`-n ${(0,o.encodeComponent)(t[C].value)}`||S||"",j=0!==s&&(!!g&&`${y} ${g}${((e,t)=>{if("get"===g){const o=$>=0?t[$].value:e.length>1?e[0]:n;return o?" "+o:""}return"krew"===g?" "+n:""})(k,t)} ${(0,o.encodeComponent)(w)} ${x} ${Z}`),A=r&&"string"==typeof j?(0,a.QG)(r,j):j,L=0===s?"header-cell":"",U=new RegExp(/STATUS|REASON|MESSAGE/i),V=v?(0,a.Dk)(l)?`${t[0].value}-${v}`:v:`${t[0].value}-${s}`;return{key:t[0].key,name:I,rowKey:V,fontawesome:D?"fas fa-check":void 0,onclick:0===E&&A,onclickIdempotent:!0,css:O+(t[0].key===u?" kui--table-cell-is-name":""),rowCSS:T,outerCSS:`${L} ${f[t[0].key]||""}`,attributes:t.slice(1).map((({key:e,value:t},n)=>{return{key:e,tag:s>0&&h[e],onclick:n+1===E&&A,outerCSS:(L+" "+(f[e]||"")+(n<=1||n===E-1||U.test(e)?"":" hide-with-sidecar")).trim(),css:(" "+(s>0&&m[e]||"")+" "+(c.Z[t]||"READY"===e&&b(t)||(o=t,/failed/i.test(o)?i.Z.Red:""))).trim(),value:"STATUS"===e&&s>0?t||d("Unknown"):t};var o})).concat(p(t.length,R))}})),D=yield k(n,r);return{header:Object.assign(P[0],{key:P[0].key||P[0].name,name:w(P[0].name),isSortable:"CURRENT"!==P[0].name,attributes:(P[0].attributes||[]).map((e=>Object.assign(e,{value:w(e.value)})))}),body:P.slice(1),noSort:!0,title:N||n||"",breadcrumbs:D}}));function O(e){return"string"==typeof e||(0,o.isTable)(e)||Array.isArray(e)&&e.length>0&&(0,o.isTable)(e[0])}function S(e,t){const n=t.split(/\n/).filter((e=>/NotFound/.test(e))).map((e=>e.match(/"([^"]+)" not found/)[1]));if(n.length>0){const t=0===e.body.length?-1:e.body[0].attributes.findIndex((e=>/STATUS/i.test(e.key))),o=0===e.body.length?[]:Array(e.body[0].attributes.length).fill(void 0).map(((e,n)=>{const o={};if(n===t){const e="Offline";o.value=e,o.tag=h.STATUS,o.outerCSS=f.STATUS,o.css=[m.STATUS,c.Z[e]].join(" ")}return o}));n.forEach((t=>{e.body.push({name:t,isDeleted:!0,attributes:o})}))}return e}function $(e){const{data:t}=e.execOptions;if(function(e){return"object"==typeof e&&e.constructor!==u}(t)&&!function(e){return"object"==typeof e&&e.constructor===u}(t)&&"number"==typeof t.limit)return t.limit}const E=(e,t,n,o,i,r,s)=>l(void 0,void 0,void 0,(function*(){const a=g(e.split(/^(?=LAST SEEN|NAMESPACE|NAME\s+)/m));if(a&&1===a.length&&0===a[0].length)return e||t;if(a&&a.length>=1){if(1===a.length){const e=$(n);e&&a[0].length>e&&(a[0]=[a[0][0]].concat(a[0].slice(-e)));const c=yield x(o,i,r,n,a[0],s);return n.execOptions.filter&&(c.body=n.execOptions.filter(c.body)),S(c,t)}return Promise.all(a.map((e=>l(void 0,void 0,void 0,(function*(){const s=yield x(o,i,r,n,e,void 0);return n.execOptions.filter&&(s.body=n.execOptions.filter(s.body)),S(s,t)})))))}return e}));function C(e){if((0,o.isTable)(e)){const t=e.header.attributes,n=t.findIndex((e=>"STATUS"===e.key)),o=t.findIndex((e=>"START"===e.key)),i=t.findIndex((e=>"START2"===e.key)),r=t.findIndex((e=>"END"===e.key)),s=t.findIndex((e=>"Duration"===e.key));if(s>=0)return e.statusColumnIdx=n,e.startColumnIdx=o,e.completeColumnIdx=r,e.durationColumnIdx=s,e;e.statusColumnIdx=n,o>=0&&r>=0&&(e.startColumnIdx=o,e.completeColumnIdx=r,e.durationColumnIdx=t.length,t.push({key:"Duration",value:"Duration"}),i>=0&&(e.coldStartColumnIdx=t.length,t.push({key:"Cold Start",value:"Cold Start",outerCSS:"hide-with-sidecar"}),t[i].outerCSS="hide"),e.body.forEach((e=>{const t=e.attributes[o],n=e.attributes[r],s=new Date(t.value).getTime(),a=new Date(n.value).getTime()-s;if(e.attributes.push({key:"Duration",value:isNaN(a)?"":a.toString()}),i>=0){const t=new Date(e.attributes[i].value).getTime()-s;e.attributes[i].outerCSS="hide",e.attributes.push({key:"Cold Start",value:isNaN(t)?"":t.toString(),outerCSS:"hide-with-sidecar"})}})))}return e}function R(e,t){const n="string"==typeof e?new RegExp(`^${e}$`,"i"):void 0,o="number"==typeof e?e:t.header.attributes.findIndex((e=>n.test(e.key)));if(o>=0){const e=t.header.attributes[o];e&&e.outerCSS&&(e.outerCSS=e.outerCSS.replace(/kui--hide-in-narrower-windows/,""),e.outerCSS=e.outerCSS.replace(/hide-with-sidecar/,"")),t.body.forEach((e=>{const t=e.attributes[o];t&&t.outerCSS&&(t.outerCSS=t.outerCSS.replace(/kui--hide-in-narrower-windows/,""),t.outerCSS=t.outerCSS.replace(/hide-with-sidecar/,""))}))}}function N(e,t){if(!t.header)return;const n="string"==typeof e?new RegExp(`^${e}$`,"i"):void 0,o="number"==typeof e?e:t.header.attributes.findIndex((e=>n.test(e.key)));if(o>=0){t.header.attributes[o].outerCSS+="kui--hide-in-narrower-windows",t.body.forEach((e=>{const t=e.attributes[o];t&&t.outerCSS&&(t.outerCSS+="kui--hide-in-narrower-windows")}))}}function P(e){if(e.header){if(!e.header.attributes.find((e=>/STATUS/i.test(e.key)||/READY/i.test(e.key)))){const t="Status";e.header.attributes.push({key:t,value:t}),e.body.forEach((e=>function(e,t=!e.attributes.find((e=>/STATUS/i.test(e.key)||/READY/i.test(e.key)))){if(t){const t="Status";e.attributes.push({key:t,value:"Ready",tag:"badge",css:i.Z.Green})}}(e,!0)))}}return e}function D(e,t){return`${e.name}_${t}_${e.namespace}`}function T(e,t,n,r,s=!1,u){const l=(0,a.QI)(n),p=(0,a.Dk)(n.parsedOptions),y=e.columnDefinitions.map((e=>u?u.includes(e.name):"wide"===l||0===e.priority)),g=e.columnDefinitions.filter((e=>u?u.includes(e.name):"wide"===l||0===e.priority)),k=u?g.slice().sort(((e,t)=>u.indexOf(e.name)-u.indexOf(t.name))):g,w=t,x={name:p?"Namespace":k[0].name,attributes:k.slice(p?0:1).map((e=>{const t=e.name.toUpperCase();return{key:t,value:e.name,outerCSS:f[t]}}))},O=e.rows.map((e=>{const t=e.cells.filter(((e,t)=>y[t])).map(((e,t)=>({cell:e,index:t}))).sort(((e,t)=>k.findIndex((t=>t.name===g[e.index].name))-k.findIndex((e=>e.name===g[t.index].name)))).map((e=>e.cell)),s=((e,t)=>{const i=`-n ${e.object.metadata.namespace}`;return(0,a.QG)(n,`${r} get ${w} ${(0,o.encodeComponent)(t)} -o yaml ${i}`)})(e,e.object.metadata.name);return{object:e.object,key:p?e.object.metadata.namespace:k[0].name.toUpperCase(),rowKey:D(e.object.metadata,w),name:p?e.object.metadata.namespace:t[0].toString(),onclickIdempotent:!0,onclick:!p&&s,attributes:t.slice(p?0:1).map(((e,t)=>{const n=k[p?t:t+1].name.toUpperCase(),o=e.toString();return{key:n,value:o,tag:h[n]||v[w]&&v[w][n],onclick:!(!p||t>0)&&s,outerCSS:f[n],css:[m[n],c.Z[o],/Ready/i.test(n)?b(o):"",/failed/i.test(o)?i.Z.Red:""].join(" ")}}))}})),S=(0,a.Dk)(n.parsedOptions)&&[{label:d("all")}]||(e.rows.length>0&&e.rows.every((({object:e})=>e.metadata.namespace))?[{label:e.rows[0].object.metadata.namespace}]:void 0),$={header:x,body:O,title:t,resourceVersion:e.metadata.resourceVersion,breadcrumbs:S};return s?P($):$}},68491:(e,t,n)=>{"use strict";n.d(t,{xJ:()=>s,PS:()=>a,vm:()=>c,rJ:()=>l,kL:()=>d,ZP:()=>p});var o=n(51173),i=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const r=(0,o.i18n)("plugin-kubectl"),s="last applied",a=r("lastApplied"),c=998;function u(e){const t=e.metadata.annotations;return void 0!==t?t["kubectl.kubernetes.io/last-applied-configuration"]:void 0}function l(e){return!e.isSimulacrum&&void 0!==u(e)}const d=(e,t)=>i(void 0,void 0,void 0,(function*(){const{safeDump:e}=yield n.e(3320).then(n.t.bind(n,93320,23));return{content:e(JSON.parse(u(t))),contentType:"yaml"}})),p={when:l,mode:{mode:s,label:a,order:c,content:d}}},68281:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var o=n(51173),i=n(21274);const r={mode:"logs",label:(0,o.i18n)("plugin-kubectl","logs")("Logs"),content:(e,t,o)=>Promise.all([n.e(2320),n.e(3168),n.e(9722)]).then(n.bind(n,87645)).then((n=>n.content(e,t,o)))},s={when:i.th,mode:r}},41653:(e,t,n)=>{"use strict";n.d(t,{xJ:()=>i,PS:()=>r,vm:()=>s,ZP:()=>a});var o=n(21274);const i="raw",r="YAML",s=999,a={when:o.BJ,mode:{mode:i,label:r,content:(e,t)=>({content:t.kuiRawData,contentType:"yaml"}),order:s}}},61032:e=>{"use strict";e.exports=JSON.parse('{"name":"@kui-shell/plugin-kubectl","version":"10.2.0","description":"Kubernetes visualization plugin for kubernetes","license":"Apache-2.0","keywords":["kubernetes","kubectl","cli","ui","kui","plugin"],"author":"@starpit","contributors":["Mengting Yan"],"homepage":"https://github.com/IBM/kui#readme","bugs":{"url":"https://github.com/IBM/kui/issues/new"},"repository":{"type":"git","url":"git+https://github.com/IBM/kui.git"},"main":"dist/index.js","module":"mdist/index.js","types":"mdist/index.d.ts","dependencies":{"bytes-iec":"3.1.1","command-exists":"1.2.9","debug":"4.3.1","fs-extra":"9.1.0","js-yaml":"3.14.1","jsonpath":"github:starpit/jsonpath#preparse","needle":"2.6.0","parse-duration":"0.4.4","semver":"7.3.4","tmp":"0.2.1","uuid":"8.3.2"},"krew":{"commandPrefix":"kubeui"},"publishConfig":{"access":"public"},"gitHead":"89de9f78e8a1a2bdd29d2e17d7c608ab006c6d32"}')},18066:()=>{},75976:()=>{},32574:()=>{},32383:()=>{},63906:()=>{},61758:()=>{}}]);