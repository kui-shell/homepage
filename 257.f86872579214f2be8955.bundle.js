(self.webpackChunkkui_shell=self.webpackChunkkui_shell||[]).push([[257],{30257:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>v});var r=t(19945);var o=t(51173),a=function(e,n,t,r){return new(t||(t=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function l(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,l)}c((r=r.apply(e,n||[])).next())}))};const i=(0,o.i18n)("plugin-kubectl","krew"),l=e=>n=>(0,r.lN)(n)?(0,r.t$)(e,n):(0,r.A)(n,void 0,e,{verb:"krew",entityType:"info"});var c=function(e,n,t,r){return new(t||(t=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function l(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,l)}c((r=r.apply(e,n||[])).next())}))};function s(e){if(e.length>0)return{key:e[0].key,name:e[0].key,attributes:e[0].attributes.map((({key:e})=>({key:e,value:e})))}}function u(e,n,t){return{key:"Group",name:e,attributes:[{key:"STATUS",value:3===t?"Error":2===t?"Warning":"OK",tag:"badge",css:3===t?"red-background":2===t?"yellow-background":"green-background"},{key:"Message",value:n}]}}var d=function(e,n,t,r){return new(t||(t=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function l(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,l)}c((r=r.apply(e,n||[])).next())}))};const k=["k","kubectl"],p="kubectl",v=e=>d(void 0,void 0,void 0,(function*(){k.forEach((n=>{e.listen(`/${r.zh}/${n}/krew/help`,(e=>n=>(0,r.t$)(e,n))(p),r.pb),e.listen(`/${r.zh}/${n}/krew/info`,(e=>n=>a(void 0,void 0,void 0,(function*(){if((0,r.lN)(n))return(0,r.t$)(e,n);{const e=yield(0,r.d1)(n),t=e.match(/^\S+:/gm),o=t.map((n=>e.indexOf(n))).map(((n,r,o)=>e.slice(n+t[r].length,o[r+1]).trim())),a=t.reduce(((e,n,t)=>(e[n]=o[t],e)),{}),l=a["URI:"]?[{label:i("Download"),href:a["URI:"]}]:[],c=a["HOMEPAGE:"]?[{label:i("Home Page"),href:a["HOMEPAGE:"]}]:[],s=l.concat(c);return{apiVersion:"kui-shell/v1",kind:"NavResponse",menus:[{label:i("Plugin"),items:[{mode:"overview",label:i("Overview"),content:t.filter((e=>"HOMEPAGE:"!==e&&"CAVEATS:"!==e&&"URI:"!==e)).reduce(((e,n)=>e+`\n  ### ${n}\n  ${"NAME:"===n?"#### ":""}${"SHA256:"===n?"`":""}${a[n]}${"SHA256:"===n?"`":""}`),""),contentType:"text/markdown"}].concat(a["CAVEATS:"]?[{mode:"caveats",label:i("Caveats"),contentType:"text/markdown",content:a["CAVEATS:"].replace(/^\\\n/,"").replace(/\n\/$/,"").replace(/ \| /g,"").replace(/(export \S+=.*)/g,"`$1`").replace(/(%USERPROFILE\S+)/g,"`$1`").replace(/\n\s+\$(.*)/g,"\n   ```\n$1\n   ```\n")}]:[])}],links:s,breadcrumbs:[{label:"krew",command:"kubectl krew list"},{label:"info"},{label:o[0]}]}}})))(p),r.pb),e.listen(`/${r.zh}/${n}/krew/list`,(e=>n=>(0,r.lN)(n)?(0,r.t$)(e,n):(0,r.A)(n,void 0,e,{usePty:!0,nameColumn:"PLUGIN",verb:"krew",entityType:"info"}))(p),r.pb),e.listen(`/${r.zh}/${n}/krew/search`,l(p),r.pb),e.listen(`/${r.zh}/${n}/krew/version`,l(p),r.pb),e.listen(`/${r.zh}/${n}/popeye`,(e=>n=>c(void 0,void 0,void 0,(function*(){if((0,r.lN)(n))return(0,r.t$)(e,n);{const t=n.parsedOptions.s||n.parsedOptions.sections;let o;const a=e=>(o=t&&e.argvNoOptions[e.argvNoOptions.indexOf("popeye")+1],o?`${e.command.replace(o,"")} -o json`:`${e.command} -o json`),i=yield(0,r.d1)(n,a,e),l=JSON.parse(i).popeye,d=yield(0,r.D_)(n),k=(e,n,t)=>({header:s(e),body:e,statusColumnIdx:0,breadcrumbs:[{label:"Popeye"},{label:d}],title:n,footer:t}),p=()=>{const n=l.sanitizers.map((({sanitizer:n,tally:t})=>({key:"Name",name:n,onclick:`${e} popeye -s ${n} -n ${d}`,attributes:[{key:"Score",value:t.score.toString(),tag:"badge",css:100===t.score?"green-background":"red-background"},{key:"Error",value:t.error.toString()},{key:"Warning",value:t.warning.toString()},{key:"Info",value:t.info.toString()},{key:"Ok",value:t.ok.toString()}]})));return k(n,"All resources",[`Overall score: ${l.score} ${l.grade}`])},v=()=>c(void 0,void 0,void 0,(function*(){const o=[];return l.sanitizers.forEach((({issues:n,sanitizer:t,tally:r})=>{n?Object.entries(n).forEach((([n,r])=>{if(n){let a=0;r.forEach((({level:e})=>a=e>a?e:a));const i=n.split(/\//);o.push({key:"Name",name:i.length>1?i[1]:i[0],onclick:`${e} popeye -s ${t} ${n} -n ${d}`,attributes:[{key:"Status",value:3===a?"Error":2===a?"Warning":"OK",tag:"badge",css:3===a?"red-background":2===a?"yellow-background":"green-background"}]})}else r.forEach((e=>o.push(u(e.group,e.message,e.level))))})):o.push({key:"Name",name:t,attributes:[{key:"Score",value:r.score.toString(),tag:"badge",css:100===r.score?"green-background":"red-background"},{key:"Error",value:r.error.toString()},{key:"Warning",value:r.warning.toString()},{key:"Info",value:r.info.toString()},{key:"Ok",value:r.ok.toString()}]})})),k(o,yield(0,r.ZK)(e,n,t),[`Overall score: ${l.score} ${l.grade}`])})),g=()=>{const e=l.sanitizers[0].issues[o].map((({group:e,level:n,message:t})=>u(e,t,n)));return k(e,o.split(/\//)[1])};return o?g():t?v():p()}})))(p),r.pb)}))}))}}]);